(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{142:function(e){e.exports={environment:"prod",apiBaseRoute:"/psh-api",socketioBaseRoute:null}},261:function(e){e.exports={settings:{nginxConfigPath:"Nginx configuration file path",nginxHtpasswdDir:"Nginx Basic Auth config directory path",composeConfigPath:"Docker-compose configuration file path",defaultNginxDomain:"Default root domain name"}}},5507:function(e,t,a){e.exports=a(5741)},5546:function(e,t){},5549:function(e,t,a){},5551:function(e,t,a){},5741:function(e,t,a){"use strict";a.r(t);var n=a(4),r=a.n(n),i=a(7),o=a(0),s=a.n(o),l=a(27),c=a.n(l),u=a(5745),d=a(5743),m=a(26),p=a(90),h={token:null,userId:null,online:!1},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGGIN_USER":return e=Object.assign({},e,t.data);default:return e}},g=[],E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NETWORKS":return t.data;default:return e}},v=[],b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_BASICAUTH":return t.data;default:return e}},k=[],y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DOCKER_IMAGES":return t.data;default:return e}},S=[],x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CONTAINERS":return t.data;case"UPDATE_CONTAINER":return e.map(function(e){return e.id==t.data.id?t.data:e});default:return e}},_=[],C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SOLUTIONS":return t.data;case"DELETE_SOLUTION":return e.filter(function(e){return e.id!=t.data});default:return e}},D=[],O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SOLUTION_PARAMETERS":return t.data;case"DELETE_SOLUTION_PARAMETER":return e.filter(function(e){return e.id!=t.data});default:return e}},N=[],w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DOMAINS":return t.data;default:return e}},A=[],I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NGINX_CONFIGS":return t.data;default:return e}},T=[],P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SETTINGS":return t.data;default:return e}},j=a(38),R=[],L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NGINX_DOCKER_LINKS":return t.data;case"ADD_NGINX_DOCKER_LINKS":return[].concat(Object(j.a)(e),Object(j.a)(t.data));case"DELETE_NGINX_DOCKER_LINK":return e.filter(function(e){return e.id!=t.data});default:return e}},B={},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_LITERALS":return e=Object.assign({},e,t.data);default:return e}},V=[],M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NGINX_PRESET_PARAMS":return t.data;default:return e}},U=function(){return Object(p.c)(Object(p.b)({userSession:f,networks:E,dockerImages:y,containers:x,domains:w,nginxConfigs:I,nginxPresetParams:M,settings:P,basicAuth:b,literals:F,solutions:C,solutionParameters:O,nginxDockerLinks:L}))},W=a(16),G=a(17),z=function(){function e(){Object(W.a)(this,e)}return Object(G.a)(e,null,[{key:"createEntity",value:function(e){this.endpoints[e.name]=this.createBasicCRUDEndpoints(e)}},{key:"createEntities",value:function(e){e.forEach(this.createEntity.bind(this))}},{key:"createBasicCRUDEndpoints",value:function(e){var t=this,a=e.name,n={},r="".concat(this.url,"/").concat(a);return n.getOne=function(e){return new Promise(function(a,n){fetch("".concat(r,"/findOne").concat(e?"?filter="+JSON.stringify(e):""),{method:"GET",headers:t.headers}).then(function(e){if(!e.ok){var t=new Error("An error occured");return t.status=e.status,n(t)}a(e.json())}).catch(function(e){console.log(e),n(e)})})},n.getAll=function(e){return new Promise(function(a,n){fetch("".concat(r).concat(e?"?filter="+JSON.stringify(e):""),{method:"GET",headers:t.headers}).then(function(e){if(!e.ok){var t=new Error("An error occured");return t.status=e.status,n(t)}a(e.json())}).catch(function(e){n(e)})})},n.getAllRelations=function(e,a){return new Promise(function(n,i){fetch("".concat(r,"/").concat(e,"/").concat(a),{method:"GET",headers:t.headers}).then(function(e){if(!e.ok){var t=new Error("An error occured");return t.status=e.status,i(t)}n(e.json())}).catch(function(e){i(e)})})},n.deleteById=function(e){return new Promise(function(a,n){fetch("".concat(r,"/").concat(e),{method:"DELETE",headers:t.headers}).then(function(e){if(!e.ok){var t=new Error("An error occured");return t.status=e.status,n(t)}a(e.json())}).catch(function(e){n(e)})})},n.create=function(e){return new Promise(function(a,n){fetch("".concat(r),{method:"POST",headers:t.headers,body:JSON.stringify(e)}).then(function(e){if(!e.ok){var t=new Error("An error occured");return t.status=e.status,n(t)}a(e.json())}).catch(function(e){n(e)})})},n.linkRelation=function(e,a,n,i){return new Promise(function(o,s){fetch("".concat(r,"/").concat(e,"/").concat(a,"/rel/").concat(n),{method:"PUT",headers:t.headers,body:JSON.stringify(i)}).then(function(e){if(!e.ok){var t=new Error("An error occured");return t.status=e.status,s(t)}o()}).catch(function(e){s(e)})})},n.unlinkRelation=function(e,a,n){return new Promise(function(i,o){fetch("".concat(r,"/").concat(e,"/").concat(a,"/rel/").concat(n),{method:"DELETE",headers:t.headers}).then(function(e){if(!e.ok){var t=new Error("An error occured");return t.status=e.status,o(t)}i()}).catch(function(e){o(e)})})},n.update=function(e){return new Promise(function(a,n){fetch("".concat(r),{method:"PUT",headers:t.headers,body:JSON.stringify(e)}).then(function(e){if(!e.ok){var t=new Error("An error occured");return t.status=e.status,n(t)}a(e.json())}).catch(function(e){n(e)})})},n.remote=function(e,a,n,i){return new Promise(function(o,s){fetch("".concat(r,"/").concat(e).concat(a?"/"+a:""),{method:n,headers:t.headers,body:JSON.stringify(i)}).then(function(e){if(!e.ok){var t=new Error("An error occured");return t.status=e.status,s(t)}o(204!=e.status?e.json():null)}).catch(function(e){s(e)})})},n.solutionExport=function(e,a){return new Promise(function(n,i){fetch("".concat(r,"/exportSolution/").concat(e),{method:"POST",headers:{Authorization:t.headers.Authorization},body:a}).then(function(e){if(!e.ok){var t=new Error("Invalide Dockerfile folder");return t.status=e.status,i(t)}n(e)}).catch(function(e){i(e)})})},n.solutionImport=function(e){return new Promise(function(a,n){fetch("".concat(r,"/importSolution"),{method:"POST",headers:{Authorization:t.headers.Authorization},body:e}).then(function(e){if(!e.ok){var t=new Error("An error occured");return t.status=e.status,n(t)}a(204!=e.status?e.json():null)}).catch(function(e){n(e)})})},n.uploadCertificate=function(e,a){return new Promise(function(n,i){fetch("".concat(r,"/uploadCertificate/").concat(e),{method:"POST",headers:{Authorization:t.headers.Authorization},body:a}).then(function(e){if(!e.ok){var t=new Error("An error occured");return t.status=e.status,i(t)}n(204!=e.status?e.json():null)}).catch(function(e){i(e)})})},n.remoteGet=function(e,a){var n=[];for(var i in a=a||{})n.push(i+"="+encodeURIComponent(a[i]));return new Promise(function(a,i){fetch("".concat(r,"/").concat(e).concat(n.length>0?"?"+n.join("&"):""),{method:"GET",headers:t.headers}).then(function(e){if(!e.ok){var t=new Error("An error occured");return t.status=e.status,i(t)}a(e.json())}).catch(function(e){i(e)})})},n.buildRemoteFileUri=function(e,a){var n=[];for(var i in a=a||{})n.push(i+"="+encodeURIComponent(a[i]));return t.headers.Authorization&&n.push("access_token="+t.headers.Authorization),"".concat(r,"/").concat(e).concat(n.length>0?"?"+n.join("&"):"")},n.upload=function(e,a,n){return new Promise(function(i,o){fetch("".concat(r,"/").concat(e).concat(a?"/"+a:""),{method:"POST",headers:{"Content-Type":"multipart/form-data",Authorization:t.headers.Authorization},body:n}).then(function(e){if(!e.ok){var t=new Error("An error occured");return t.status=e.status,o(t)}i(e.json())}).catch(function(e){o(e)})})},n}}]),e}();z.headers={Accept:"application/json","Content-Type":"application/json"},z.url=a(142).apiBaseRoute,z.endpoints={},z.createEntity({name:"SdfUsers"}),z.createEntity({name:"Networks"}),z.createEntity({name:"DockerImages"}),z.createEntity({name:"Containers"}),z.createEntity({name:"NginxConfigs"}),z.createEntity({name:"NginxPresetParams"}),z.createEntity({name:"Domains"}),z.createEntity({name:"BasicAuths"}),z.createEntity({name:"Settings"}),z.createEntity({name:"Solutions"}),z.createEntity({name:"SolutionParameters"}),z.createEntity({name:"NginxDockerLinks"});var H=z,K=a(5518),q=function(){function e(){Object(W.a)(this,e)}return Object(G.a)(e,null,[{key:"login",value:function(e){var t=this,n=a(142).socketioBaseRoute;console.log("=> Connecting to socket IO server: ","".concat(window.location.protocol,"//").concat(window.location.hostname)),this.socket=K(n||"".concat(window.location.protocol,"//").concat(window.location.hostname),{path:"/psh-socket"}),this.socket.on("connect",function(){console.log("connected"),t.socket.emit("registerSockerUser",{uid:e}),t.store.dispatch({type:"LOGGIN_USER",data:{online:!0}})}),this.socket.on("dataUpdate",function(e){}),this.socket.on("deployStatus",function(e){t.subscriptions.forEach(function(t){"deployStatus"==t.eventName&&t.cb(e)})}),this.socket.on("importStatus",function(e){t.subscriptions.forEach(function(t){"importStatus"==t.eventName&&t.cb(e)})}),this.socket.on("containerStatus",function(e){t.subscriptions.forEach(function(t){"containerStatus"==t.eventName&&t.cb(e)})}),this.socket.on("disconnect",function(){console.log("Disconnected"),t.store.dispatch({type:"LOGGIN_USER",data:{online:!1}})})}},{key:"logout",value:function(){this.socket&&(this.socket.disconnect(),this.socket=null)}},{key:"on",value:function(e,t){this.subscriptions.push({eventName:e,cb:t})}},{key:"off",value:function(e){this.subscriptions=this.subscriptions.filter(function(t){return t.eventName!=e})}}]),e}();q.store=null,q.socket=null,q.subscriptions=[];var J=q,Y=function(){function e(){Object(W.a)(this,e)}return Object(G.a)(e,null,[{key:"login",value:function(){var e=Object(i.a)(r.a.mark(function e(t){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.endpoints.SdfUsers.remote("login",null,"POST",t);case 2:return a=e.sent,e.next=5,this.setUser(a);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setUser",value:function(){var e=Object(i.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:J.login(t.userId),H.headers.Authorization=t.id,sessionStorage.accessToken=JSON.stringify(t),this.store.dispatch({type:"LOGGIN_USER",data:{token:t.id,userId:t.userId}});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:J.logout(),this.store.dispatch({type:"LOGGIN_USER",data:{token:null}}),delete H.headers.Authorization,sessionStorage.accessToken=null;case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}();Y.store=null;var X=Y;a(5549),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Z=a(21),$=a(20),Q=a(22),ee=a(5744),te=(a(5551),function(e){function t(){return Object(W.a)(this,t),Object(Z.a)(this,Object($.a)(t).apply(this,arguments))}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"render",value:function(){return s.a.createElement(ee.a,{to:"/login"})}}]),t}(o.Component)),ae=Object(m.b)(function(e,t){return{userSession:e.userSession}},function(e){return{dispatch:e}})(te),ne=a(24),re=function(e){return{root:{flexGrow:1},title:{fontSize:32,color:"#ffffff"},paper:{padding:e.spacing.unit,backgroundColor:"rgba(255, 255, 255, 0.8)",position:"relative"},margin:{margin:2*e.spacing.unit},padding:{padding:e.spacing.unit},redColor:{color:"#db1d1d"},greenColor:{color:"green"},blueColor:{color:"blue"},greyColor:{color:"#cccccc"},modalPaper:{position:"absolute",width:50*e.spacing.unit,backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],padding:4*e.spacing.unit},tableTitleDiv:{fontSize:28,marginTop:5,marginBottom:10,textAlign:"left"},tableCell:{whiteSpace:"normal",wordWrap:"break-word"},snackClose:{padding:e.spacing.unit/2},configPaper:{padding:e.spacing.unit,position:"relative",textAlign:"left",paddingLeft:10,paddingRight:10,backgroundColor:"rgba(255, 255, 255, 0.8)"},menuItem:{},menuItemSelected:{backgroundColor:"#bbbbbb"},primary:{},icon:{},viewContainer:{borderLeft:"10px solid #cccccc"},emptyView:{height:400,backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center"}}},ie=a(91),oe=a.n(ie),se=a(1),le=a(126),ce=a.n(le),ue=a(78),de=a.n(ue),me=function(e){function t(e){return Object(W.a)(this,t),Object(Z.a)(this,Object($.a)(t).call(this,e))}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"render",value:function(){return this.props.show?s.a.createElement("div",{style:{position:"fixed",zIndex:2e3,top:0,bottom:0,left:0,right:0,flex:1,alignItems:"center",justifyContent:"center",textAlign:"center",backgroundColor:"rgba(0, 0, 0, 0.7)"}},s.a.createElement("img",{className:"Loading",src:oe.a}),s.a.createElement("div",{style:{color:"#ffffff",fontWeight:"bold",lineHeight:2,paddingLeft:40,paddingRight:40}},this.props.message?this.props.message:"Processing...")):null}}]),t}(o.Component),pe=function(){function e(){Object(W.a)(this,e)}return Object(G.a)(e,null,[{key:"loadStoreData",value:function(){var e=Object(i.a)(r.a.mark(function e(t){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.initialized){e.next=7;break}return e.next=3,this.reloadCoreData(t);case 3:return e.next=5,H.endpoints.Settings.getAll();case 5:a=e.sent,t({type:"SET_SETTINGS",data:a});case 7:this.initialized=!0;case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"clearStoreData",value:function(){var e=Object(i.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.initialized=!1,t({type:"SET_NETWORKS",data:[]}),t({type:"SET_BASICAUTH",data:[]}),t({type:"SET_CONTAINERS",data:[]}),t({type:"SET_DOCKER_IMAGES",data:[]}),t({type:"SET_DOMAINS",data:[]}),t({type:"SET_NGINX_CONFIGS",data:[]}),t({type:"SET_NGINX_PRESET_PARAMS",data:[]}),t({type:"SET_SETTINGS",data:[]});case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"reloadCoreData",value:function(){var e=Object(i.a)(r.a.mark(function e(t){var a,n,i,o,s,l,c,u,d,m,p,h;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.endpoints.Networks.getAll();case 2:return a=e.sent,t({type:"SET_NETWORKS",data:a}),e.next=6,H.endpoints.BasicAuths.getAll();case 6:return n=e.sent,t({type:"SET_BASICAUTH",data:n}),e.next=10,H.endpoints.DockerImages.getAll();case 10:return i=e.sent,t({type:"SET_DOCKER_IMAGES",data:i}),e.next=14,H.endpoints.Containers.getAll();case 14:o=e.sent,s=0;case 16:if(!(s<o.length)){e.next=24;break}return e.next=19,H.endpoints.Containers.getAllRelations(o[s].id,"networks");case 19:l=e.sent,o[s].networks=l.map(function(e){return e.id});case 21:s++,e.next=16;break;case 24:return t({type:"SET_CONTAINERS",data:o}),e.next=27,H.endpoints.Solutions.getAll();case 27:return c=e.sent,t({type:"SET_SOLUTIONS",data:c}),e.next=31,H.endpoints.NginxDockerLinks.getAll();case 31:return u=e.sent,t({type:"SET_NGINX_DOCKER_LINKS",data:u}),e.next=35,H.endpoints.SolutionParameters.getAll();case 35:return d=e.sent,t({type:"SET_SOLUTION_PARAMETERS",data:d}),e.next=39,H.endpoints.Domains.getAll();case 39:return m=e.sent,t({type:"SET_DOMAINS",data:m}),e.next=43,H.endpoints.NginxConfigs.getAll();case 43:return p=e.sent,t({type:"SET_NGINX_CONFIGS",data:p}),e.next=47,H.endpoints.NginxPresetParams.getAll();case 47:h=e.sent,t({type:"SET_NGINX_PRESET_PARAMS",data:h});case 49:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),e}();pe.initialized=!1;var he=pe,fe=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).state={selectedPageIndex:a.props.pageIndex,loading:!1,loadingMessage:null},a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"componentDidMount",value:function(){var e=this;J.on("deployStatus",function(t){t.status&&"done"==t.status?(e.setState({loading:!1,loadingMessage:null}),e.props.notify(["Successfully deployed configuration.","If you changed the SSL status of the default config, remember to manually change your URL in your browser to get back to this website.","Your server might take up to a minute to respond again, so be patient."])):t.status&&"error"==t.status?(e.setState({loading:!1,loadingMessage:null}),e.props.notify(t.message?t.message:"An error occured, could not deploy configuration","error")):t.message&&e.setState({loadingMessage:t.message})}),this.props.userSession.token&&this.loadTableList()}},{key:"componentWillUnmount",value:function(){J.off("deployStatus")}},{key:"loadTableList",value:function(){var e=this;Object(i.a)(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.setState({loading:!0,loadingMessage:null}),t.next=4,he.loadStoreData(e.props.dispatch);case 4:e.setState({loading:!1,loadingMessage:null}),t.next=13;break;case 7:return t.prev=7,t.t0=t.catch(0),t.next=11,he.clearStoreData(e.props.dispatch);case 11:e.setState({loading:!1,loadingMessage:null}),e.props.notify("Server unavailable","error");case 13:case"end":return t.stop()}},t,null,[[0,7]])}))()}},{key:"logout",value:function(){X.logout()}},{key:"deploy",value:function(){var e=Object(i.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.props.settings.find(function(e){return"defaultNginxDomain"==e.name}))&&t.value&&0!=t.value.length){e.next=3;break}return e.abrupt("return",this.props.notify("You need to set a default domain first to be able to deploy a new config.","error"));case 3:if(this.props.domains.find(function(e){return t.value==e.value})){e.next=6;break}return e.abrupt("return",this.props.notify("You configured default domain has not ben declared in your domains.","error"));case 6:this.setState({loading:!0,loadingMessage:"Deploying..."});try{J.socket.emit("deployConfig",{uid:this.props.userSession.userId})}catch(a){this.setState({loading:!1,loadingMessage:null}),this.props.notify("An error occured, could not deploy configuration","error")}case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return s.a.createElement("div",{style:{flex:1}},s.a.createElement("div",{className:"App"},s.a.createElement("header",{className:"App-header"},s.a.createElement("img",{src:oe.a,className:"App-logo",alt:"logo"}),s.a.createElement("p",null,"Server Docker Farm"),s.a.createElement(se.b,{variant:"contained",color:"secondary",style:{textTransform:"none",position:"absolute",right:20,top:20},onClick:this.logout.bind(this)},"Logout"),s.a.createElement(se.b,{disabled:!this.props.userSession.online,variant:"contained",color:"primary",style:{textTransform:"none",position:"absolute",right:120,top:20},onClick:this.deploy.bind(this)},"Deploy")),s.a.createElement(ce.a,{value:this.state.selectedPageIndex,onChange:function(t,a){e.setState({selectedPageIndex:a}),2==a?e.props.history.push("/nginx"):3==a?e.props.history.push("/config"):0==a?e.props.history.push("/solution"):1==a&&e.props.history.push("/docker")},centered:!0,textColor:"secondary"},s.a.createElement(de.a,{label:"Solutions",style:0!=this.state.selectedPageIndex?{color:"#ffffff"}:null}),s.a.createElement(de.a,{label:"Containers",style:1!=this.state.selectedPageIndex?{color:"#ffffff"}:null}),s.a.createElement(de.a,{label:"NGinx",style:2!=this.state.selectedPageIndex?{color:"#ffffff"}:null}),s.a.createElement(de.a,{label:"Settings",style:3!=this.state.selectedPageIndex?{color:"#ffffff"}:null})),s.a.createElement("div",{className:"App-body"},this.props.children)),s.a.createElement(me,{show:this.state.loading,message:this.state.loadingMessage}))}}]),t}(o.Component),ge=Object(m.b)(function(e,t){return{userSession:e.userSession,domains:e.domains,settings:e.settings}},function(e){return{dispatch:e}})(fe),Ee=a(262),ve=a(9),be=a.n(ve),ke=a(127),ye=a.n(ke),Se=a(129),xe=a.n(Se),_e=a(130),Ce=a.n(_e),De=a(30),Oe=a.n(De),Ne=a(259),we=a.n(Ne),Ae=a(260),Ie=a.n(Ae),Te=a(46),Pe=a.n(Te),je=a(131),Re=a.n(je),Le=a(102),Be=a.n(Le),Fe=a(128),Ve=a.n(Fe),Me={success:ye.a,warning:Ve.a,error:xe.a,info:Ce.a};var Ue=Object(ne.withStyles)(function(e){return{success:{backgroundColor:we.a[600]},error:{backgroundColor:e.palette.error.dark},info:{backgroundColor:e.palette.primary.dark},warning:{backgroundColor:Ie.a[700]},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing.unit},message:{display:"flex",alignItems:"left"}}})(function(e){var t=e.classes,a=e.className,n=e.message,r=e.onClose,i=e.variant,o=Object(Ee.a)(e,["classes","className","message","onClose","variant"]),l=Me[i],c=[];return"string"===typeof n?c.push(n):c=n,s.a.createElement(Be.a,Object.assign({className:be()(t[i],a),"aria-describedby":"client-snackbar",message:s.a.createElement("span",{id:"client-snackbar",className:t.message},s.a.createElement(l,{className:be()(t.icon,t.iconVariant)}),s.a.createElement("div",null,c.map(function(e,t){return s.a.createElement("div",{key:"snack_"+t,style:{textAlign:"left",marginTop:t>0?10:0,maxWidth:480}},e)}))),action:[s.a.createElement(Pe.a,{key:"close","aria-label":"Close",color:"inherit",className:t.close,onClick:r},s.a.createElement(Oe.a,{className:t.icon}))]},o))}),We=function(e){function t(){var e,a;Object(W.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(Z.a)(this,(e=Object($.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1},a.handleClose=function(e,t){"clickaway"!==t&&a.props.handleClose()},a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"render",value:function(){this.props.classes;var e=6e3;return!this.props.variant||"warning"!=this.props.variant&&"info"!=this.props.variant?this.props.variant&&"error"==this.props.variant&&(e=15e3):e=2e4,s.a.createElement("div",null,s.a.createElement(Re.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:this.props.open,autoHideDuration:e,onClose:this.handleClose},s.a.createElement(Ue,{onClose:this.handleClose,variant:this.props.variant?this.props.variant:"success",message:this.props.message})))}}]),t}(s.a.Component),Ge=Object(ne.withStyles)(function(e){return{margin:{margin:e.spacing.unit}}})(We),ze=a(49),He=a.n(ze),Ke=a(32),qe=a.n(Ke),Je=a(65),Ye=a.n(Je),Xe=a(54),Ze=a.n(Xe),$e=a(60),Qe=a.n($e),et=a(68),tt=a.n(et),at=function(e){function t(){var e,a;Object(W.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(Z.a)(this,(e=Object($.a)(t)).call.apply(e,[this].concat(r)))).handleClickButton=function(e){e.onClick&&e.onClick(),a.close()},a.close=function(){!function(){var e=document.getElementById("react-confirm-alert");Object(l.unmountComponentAtNode)(e),e.parentNode.removeChild(e)}()},a.keyboardClose=function(e){27===e.keyCode&&a.close()},a.componentDidMount=function(){document.addEventListener("keydown",a.keyboardClose,!1)},a.componentWillUnmount=function(){document.removeEventListener("keydown",a.keyboardClose,!1),a.props.willUnmount()},a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.title,n=t.message,r=t.buttons;return s.a.createElement(qe.a,{open:!0,onClose:this.close,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},a&&s.a.createElement(tt.a,{id:"alert-dialog-title"},a),s.a.createElement(Ze.a,null,s.a.createElement(Qe.a,{id:"alert-dialog-description"},n)),s.a.createElement(Ye.a,null,r.map(function(t,a){return s.a.createElement(He.a,{key:a,onClick:function(){return e.handleClickButton(t)}},t.label)})))}}]),t}(s.a.Component);function nt(e){!function(e){var t=document.getElementById("react-confirm-alert");t?Object(l.render)(s.a.createElement(at,e),t):(document.body.children[0].classList.add("react-confirm-alert-blur"),(t=document.createElement("div")).id="react-confirm-alert",document.body.appendChild(t),Object(l.render)(s.a.createElement(at,e),t))}(e)}at.defaultProps={buttons:[{label:"Cancel",onClick:function(){return null}},{label:"Confirm",onClick:function(){return null}}],willUnmount:function(){return null}};var rt=a(134),it=a.n(rt),ot=a(132),st=a.n(ot),lt=a(133),ct=a.n(lt),ut=a(33),dt=function(e){return{sectionBlockHeader:{margin:"".concat(3*e.spacing.unit,"px 0px")},sectionBlockBody:{margin:"".concat(2*e.spacing.unit,"px 0px")},saveSection:{margin:"".concat(6*e.spacing.unit,"px 0px 0px")},fab:{margin:e.spacing.unit},uploadButton:{margin:e.spacing.unit},rightButtonIcon:{marginLeft:e.spacing.unit},appBar:{position:"relative",minWidth:550},flex:{flex:1},emptyLine:{fontSize:14}}},mt=function(e){function t(){var e,a;Object(W.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(Z.a)(this,(e=Object($.a)(t)).call.apply(e,[this].concat(r)))).state={isValidated:!1},a.validate=function(){var e=a.formEl,t=e.length;if(!1===e.checkValidity()){for(var n=0;n<t;n++){var r=e[n],i=void 0;null!=r.parentNode.parentNode.getAttribute("required")?(i=r.parentNode.parentNode.parentNode.querySelector(".invalid-feedback"),null==r.value||void 0==r.value||0==r.value.length?(i.textContent="Required",!0):i.textContent=""):(i="off"===r.autocomplete&&"button"!==r.nodeName.toLowerCase()?r.parentNode.parentNode.parentNode.parentNode.querySelector(".invalid-feedback"):r.parentNode.parentNode.parentNode.querySelector(".invalid-feedback"))&&"button"!==r.nodeName.toLowerCase()&&(r.validity.valid?i.textContent="":i.textContent=r.validationMessage)}return!1}for(var o=!1,s=0;s<t;s++){var l=e[s];if(null!=l.parentNode.parentNode.getAttribute("required")){var c=l.parentNode.parentNode.parentNode.querySelector(".invalid-feedback");null==l.value||void 0==l.value||0==l.value.length?(c.textContent="Required",o=!0):c.textContent=""}else{var u=l.parentNode.parentNode.parentNode.querySelector(".invalid-feedback");u&&"button"!==l.nodeName.toLowerCase()&&(u.textContent="")}}return!o},a.submitHandler=function(e){e.preventDefault(),a.validate()&&a.props.onSubmit(),a.setState({isValidated:!0})},a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"render",value:function(){var e=this,t=[];return this.state.isValidated&&t.push("was-validated"),s.a.createElement("form",Object.assign({},this.props,{className:t,noValidate:!0,ref:function(t){return e.formEl=t},onSubmit:this.submitHandler}),this.props.children)}}]),t}(s.a.Component),pt=a(51),ht=a.n(pt),ft=a(5700);var gt=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).VOLUME_MAPPER={},a.saveSolution=function(){Object(i.a)(r.a.mark(function e(){var t,n,i,o,s,l,c,u,d,m,p;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!a.formEl.validate()){e.next=56;break}if(!a.props.solutions.find(function(e){return(!a.props.solution||e.id!=a.props.solution.id)&&e.name.toLowerCase()==a.state._name.toLowerCase()})){e.next=5;break}return e.abrupt("return",a.props.notify("Conflict: Solution name already in use.","error"));case 5:for(t=null,n=function(e){for(var n=a.props.nginxDockerLinks.filter(function(t){return t.containerId==a.state._solutionParameters[e].containerId}).map(function(e){return e.nginxConfigId}),r=0;r<n.length;r++)a.state["proxy_asSubdomain_"+n[r]]&&0==a.state["proxy_subdomain_"+n[r]].length&&(t="Please set the missing subdomains for the Nginx domain configs")},i=0;i<a.state._solutionParameters.length;i++)n(i);if(!t){e.next=10;break}return e.abrupt("return",a.props.notify(t,"error"));case 10:if(a.setState({loading:!0,loadingMessage:"Saving ..."}),o=null,!a.props.solution){e.next=23;break}return e.next=15,H.endpoints.Solutions.getOne({where:{id:a.props.solution.id}});case 15:return(o=e.sent).name=a.state._name,o.description=a.state._description,o.alias=a.props.alias,e.next=21,H.endpoints.Solutions.update(o);case 21:e.next=26;break;case 23:return e.next=25,H.endpoints.Solutions.create({name:a.state._name,description:a.state._description,alias:a.props.alias});case 25:o=e.sent;case 26:if(!a.props.solution){e.next=34;break}s=r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.props.solutionParameters[t].solutionId!=a.props.solution.id){e.next=4;break}if(a.state._solutionParameters.find(function(e){return e.containerId==a.props.solutionParameters[t].containerId})){e.next=4;break}return e.next=4,H.endpoints.SolutionParameters.deleteById(a.props.solutionParameters[t].id);case 4:case"end":return e.stop()}},e)}),l=0;case 29:if(!(l<a.props.solutionParameters.length)){e.next=34;break}return e.delegateYield(s(l),"t0",31);case 31:l++,e.next=29;break;case 34:c=r.a.mark(function e(t){var n,i,s,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.state._solutionParameters[t].id){e.next=5;break}return e.next=3,H.endpoints.SolutionParameters.update(a.state._solutionParameters[t]);case 3:e.next=7;break;case 5:return e.next=7,H.endpoints.SolutionParameters.create({solutionId:o.id,containerId:a.state._solutionParameters[t].containerId,volumes:a.state._solutionParameters[t].volumes});case 7:if(!(a.state._solutionParameters[t].volumes.length>0)){e.next=13;break}return n=a.props.containers.find(function(e){return e.id==a.state._solutionParameters[t].containerId}),a.state._solutionParameters[t].volumes.forEach(function(e){var r=a.VOLUME_MAPPER[a.state._solutionParameters[t].containerId][e.path];n.volumes=n.volumes.map(function(t){return t.containerPath==e.path&&(t.hostPath=a.state[r]),t})}),e.next=12,H.endpoints.Containers.update(n);case 12:a.props.dispatch({type:"UPDATE_CONTAINER",data:n});case 13:i=a.props.nginxDockerLinks.filter(function(e){return e.containerId==a.state._solutionParameters[t].containerId}).map(function(e){return e.nginxConfigId}),s=r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.nginxConfigs.find(function(e){return e.id==i[t]}),void 0!=a.state["proxy_uri_"+i[t]]&&(n.uriPath=a.state["proxy_uri_"+i[t]]),void 0!=a.state["proxy_subdomain_"+i[t]]&&(n.subdomain=a.state["proxy_subdomain_"+i[t]]),void 0!=a.state["proxy_domain_"+i[t]]&&(n.domainId=a.state["proxy_domain_"+i[t]]),void 0!=a.state["proxy_asSubdomain_"+i[t]]&&(n.asSubdomain=a.state["proxy_asSubdomain_"+i[t]]),e.next=7,H.endpoints.NginxConfigs.update(n);case 7:case"end":return e.stop()}},e)}),l=0;case 16:if(!(l<i.length)){e.next=21;break}return e.delegateYield(s(l),"t0",18);case 18:l++,e.next=16;break;case 21:case"end":return e.stop()}},e)}),u=0;case 36:if(!(u<a.state._solutionParameters.length)){e.next=41;break}return e.delegateYield(c(u),"t1",38);case 38:u++,e.next=36;break;case 41:return e.next=43,H.endpoints.Solutions.getAll();case 43:return d=e.sent,a.props.dispatch({type:"SET_SOLUTIONS",data:d}),e.next=47,H.endpoints.SolutionParameters.getAll();case 47:return m=e.sent,a.props.dispatch({type:"SET_SOLUTION_PARAMETERS",data:m}),e.next=51,H.endpoints.NginxConfigs.getAll();case 51:p=e.sent,a.props.dispatch({type:"SET_NGINX_CONFIGS",data:p}),a.setState({loading:!1,loadingMessage:null}),a.props.notify("Solution saved"),a.props.solutionSaved(o.id);case 56:e.next=63;break;case 58:e.prev=58,e.t2=e.catch(0),console.log(e.t2),a.setState({loading:!1,loadingMessage:null}),a.props.notify("An error occured","error");case 63:case"end":return e.stop()}},e,null,[[0,58]])}))()},a.state={_name:"",_description:"",_solutionParameters:[],availableContainersAnchorEl:null,loading:!1,loadingMessage:null},a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=[];this.props.solution?(t=JSON.parse(JSON.stringify(this.props.solutionParameters.filter(function(t){return t.solutionId==e.props.solution.id}))),this.setState({_name:this.props.solution?this.props.solution.name:"",_description:this.props.solution?this.props.solution.description:"",_solutionParameters:t}),t.forEach(function(t){e._prepareContainerStates({},t)})):this.setState({_name:this.props.solution?this.props.solution.name:"",_description:this.props.solution?this.props.solution.description:"",_solutionParameters:t})}},{key:"onLookupContainer",value:function(e){this.setState({availableContainersAnchorEl:e.currentTarget})}},{key:"onLookupVolume",value:function(e,t){var a={};a["availableVolumesAnchorEl_"+e]=t.currentTarget,this.setState(a)}},{key:"onRemoveContainer",value:function(e){var t=this,a={_solutionParameters:this.state._solutionParameters.filter(function(t){return t.containerId!=e})};Object.keys(this.VOLUME_MAPPER[e]).forEach(function(n){a[t.VOLUME_MAPPER[e][n]]=null}),delete this.VOLUME_MAPPER[e],Object.keys(this.state).forEach(function(t){0==t.indexOf("portContainer_"+e+"_")&&(a[t]=null)}),this.setState(a)}},{key:"onRemoveVolume",value:function(e,t){var a=this,n={};Object.keys(this.VOLUME_MAPPER[e]).forEach(function(r){a.VOLUME_MAPPER[e][r]==t&&(a.state._solutionParameters=a.state._solutionParameters.map(function(t){t.containerId==e&&null!=t.volumes.find(function(e){return e.path==r})&&(t.volumes=t.volumes.filter(function(e){return e.path!=r}),a.props.containers.find(function(t){return t.id==e}).volumes.forEach(function(t){t.containerPath==r&&(n[a.VOLUME_MAPPER[e][r]]=t.hostPath)}));return t}))}),n._solutionParameters=this.state._solutionParameters,this.setState(n)}},{key:"handleAvailableContainerMenuClose",value:function(e){if(e.cid){this.state._solutionParameters.push({solutionId:this.props.solution?this.props.solution.id:-1,containerId:e.cid,volumes:[]});var t={availableContainersAnchorEl:null,_solutionParameters:this.state._solutionParameters};this._prepareContainerStates(t,this.state._solutionParameters.find(function(t){return t.containerId==e.cid}))}else this.setState({availableContainersAnchorEl:null})}},{key:"_prepareContainerStates",value:function(e,t){var a=this,n={};this.props.containers.find(function(e){return e.id==t.containerId}).volumes.forEach(function(t){var a=ft.generate();n[t.containerPath]=a,e[a]=t.hostPath}),this.VOLUME_MAPPER[t.containerId]=n,this.props.nginxDockerLinks.filter(function(e){return e.containerId==t.containerId}).map(function(e){return a.props.nginxConfigs.find(function(t){return t.id==e.nginxConfigId})}).forEach(function(t){e["proxy_uri_"+t.id]=t.uriPath,e["proxy_subdomain_"+t.id]=t.subdomain,e["proxy_domain_"+t.id]=t.domainId,e["proxy_asSubdomain_"+t.id]=t.asSubdomain}),this.state._solutionParameters.forEach(function(e,t){a.state["availableVolumesAnchorEl_"+t]=null}),this.setState(e)}},{key:"handleAvailableVolumeMenuClose",value:function(e,t){var a={};a["availableVolumesAnchorEl_"+e]=null,t.volume&&(this.state._solutionParameters=this.state._solutionParameters.map(function(e){return e.containerId==t.containerId&&e.volumes.push({path:t.volume}),e}),a._solutionParameters=this.state._solutionParameters),this.setState(a)}},{key:"getDialogFormBlockUriPath",value:function(e,t){var a=this;return s.a.createElement(se.m,{item:!0,xs:3,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"proxy_uri_"+t.id,className:"form-control",value:this.state["proxy_uri_"+t.id],onChange:function(e){var n={};n["proxy_uri_"+t.id]=e.target.value,a.setState(n)},label:"URI path",type:"text"}),s.a.createElement("div",{className:"invalid-feedback"})))}},{key:"getDialogFormBlockIsSubdomain",value:function(e,t){var a=this;return s.a.createElement(se.m,{item:!0,xs:3,style:{textAlign:"left"}},s.a.createElement(se.l,{row:!0},s.a.createElement(se.k,{control:s.a.createElement(se.B,{checked:this.state["proxy_asSubdomain_"+t.id],onChange:function(e){var n={};n["proxy_asSubdomain_"+t.id]=e.target.checked,n["proxy_subdomain_"+t.id]="",a.setState(n)}}),label:"Subdomain"})))}},{key:"getDialogFormBlockSubdomain",value:function(e,t){var a=this;return s.a.createElement(se.m,{item:!0,xs:3,style:{textAlign:"left"}},this.state["proxy_asSubdomain_"+t.id]&&s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"proxy_subdomain_"+t.id,className:"form-control",value:this.state["proxy_subdomain_"+t.id],onChange:function(e){var n={};n["proxy_subdomain_"+t.id]=e.target.value,a.setState(n)},label:"Subdomain",type:"text",fullWidth:!0}),s.a.createElement("div",{className:"invalid-feedback"})))}},{key:"getDialogFormBlockDomain",value:function(e,t){var a=this;return s.a.createElement(se.m,{item:!0,xs:3,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group",style:{textAlign:"left"}},s.a.createElement(se.j,{fullWidth:!0},s.a.createElement(se.o,{htmlFor:"proxy_domain_"+t.id},"Domain"),s.a.createElement(se.z,{value:this.state["proxy_domain_"+t.id]?this.state["proxy_domain_"+t.id]:"",onChange:function(e){a.setState(Object(ut.a)({},"proxy_domain_"+t.id,e.target.value))},inputProps:{name:"proxy_domain_"+t.id,id:"proxy_domain_"+t.id},fullWidth:!0},s.a.createElement(se.w,{value:""},s.a.createElement("em",null,"None")),this.props.domains.map(function(a){return s.a.createElement(se.w,{key:"proxy_domain_item_"+e.id+"_"+t.id+"_"+a.id,value:a.id},a.value)})),s.a.createElement("div",{className:"invalid-feedback"}))))}},{key:"getSolutionContainerBlock",value:function(){var e=this,t=this.props.classes,a=this.state._solutionParameters.map(function(a,n){var r=e.props.containers.find(function(e){return e.id==a.containerId}),i=r.volumes.filter(function(e){return null==a.volumes.find(function(t){return t.path==e.containerPath})}).map(function(e){return e.containerPath}),o=e.props.nginxDockerLinks.filter(function(e){return e.containerId==r.id}).map(function(t){return e.props.nginxConfigs.find(function(e){return e.id==t.nginxConfigId})});return s.a.createElement("div",{key:"scont_"+a.containerId},s.a.createElement("div",{style:{marginTop:0==n?50:100}},s.a.createElement(se.m,{container:!0,alignItems:"center"},s.a.createElement(se.m,{item:!0,xs:!0},s.a.createElement(se.E,{gutterBottom:!0,variant:"headline",style:{color:"rgb(224, 113, 80)"}},r.name)),s.a.createElement(se.m,{item:!0},s.a.createElement(se.b,{color:"secondary",fullWidth:!0,onClick:e.onRemoveContainer.bind(e,r.id)},"Remove container")))),s.a.createElement(se.h,{variant:"middle",style:{marginLeft:0,marginRight:0}}),s.a.createElement("div",{style:{paddingLeft:30,paddingTop:20}},s.a.createElement(se.m,{container:!0,alignItems:"center"},s.a.createElement(se.m,{item:!0,xs:!0},s.a.createElement(se.E,{gutterBottom:!0,variant:"h6"},"Container volumes setup")),s.a.createElement(se.m,{item:!0},s.a.createElement(se.b,{color:"primary",fullWidth:!0,disabled:0==i.length,onClick:e.onLookupVolume.bind(e,n)},"Configure"),s.a.createElement(se.v,{id:"simple-menu-volume-"+n,anchorEl:e.state["availableVolumesAnchorEl_"+n],open:Boolean(e.state["availableVolumesAnchorEl_"+n]),onClose:e.handleAvailableVolumeMenuClose.bind(e,n)},i.map(function(t,a){return s.a.createElement(se.w,{key:"vol_mi_"+a,onClick:e.handleAvailableVolumeMenuClose.bind(e,n,{volume:t,containerId:r.id})},"Container volume : ",s.a.createElement("i",null,t))})))),s.a.createElement("div",null,a.volumes.map(function(n,i){var o=e.props.containers.find(function(e){return e.id==a.containerId}).volumes.find(function(e){return e.containerPath==n.path});return s.a.createElement("div",{key:"vol_line_"+e.VOLUME_MAPPER[r.id][n.path]},s.a.createElement(se.m,{container:!0,alignItems:"center",style:{marginTop:10}},s.a.createElement(se.m,{item:!0,xs:!0},s.a.createElement(se.m,{container:!0,alignItems:"center",style:{marginTop:20}},s.a.createElement(se.m,{item:!0,xs:!0},s.a.createElement("div",{className:"form-group",style:{paddingRight:20}},s.a.createElement(se.C,{name:e.VOLUME_MAPPER[r.id][n.path],className:"form-control",value:e.state[e.VOLUME_MAPPER[r.id][n.path]],onChange:function(t){e.setState(Object(ut.a)({},e.VOLUME_MAPPER[r.id][n.path],t.target.value))},label:"Host path",type:"text",fullWidth:!0,required:!0}),s.a.createElement("div",{className:"invalid-feedback"}))),s.a.createElement(se.m,{item:!0,xs:!0},s.a.createElement(se.E,{gutterBottom:!0,variant:"body1",style:{paddingTop:15}},"Container path:"),s.a.createElement(se.E,{gutterBottom:!0,color:"textSecondary"},n.path)),o&&o.volumeDescription&&s.a.createElement(se.m,{item:!0,xs:12},s.a.createElement(se.E,{gutterBottom:!0,style:{color:"#505050",marginLeft:-5,paddingLeft:10,paddingRight:10,paddingTop:5,paddingBottom:5,backgroundColor:"#cccccc"}},o.volumeDescription)))),s.a.createElement(se.m,{item:!0},s.a.createElement(se.i,{size:"small",className:t.fab,onClick:e.onRemoveVolume.bind(e,r.id,e.VOLUME_MAPPER[r.id][n.path])},s.a.createElement(ht.a,null)))))}),0==a.volumes.length&&s.a.createElement(se.E,{variant:"caption",className:e.props.classes.emptyLine},"-none-")),o.length>0&&s.a.createElement("div",null,s.a.createElement(se.m,{container:!0,alignItems:"center"},s.a.createElement(se.m,{item:!0,xs:!0},s.a.createElement(se.E,{gutterBottom:!0,variant:"h6",style:{marginTop:30}},"Nginx proxy configurations"))),s.a.createElement("div",null,o.map(function(t,a){return s.a.createElement(se.m,{key:"nginx_block_"+r.id+"_"+t.id,container:!0,alignItems:"center",style:{marginBottom:a+1==o.length?40:10,marginLeft:-10,padding:10,borderRadius:5,backgroundColor:"#eeeeee"}},s.a.createElement(se.m,{item:!0,xs:!0},s.a.createElement(se.m,{container:!0,spacing:16},s.a.createElement(se.m,{item:!0,xs:12},s.a.createElement(se.E,{gutterBottom:!0,color:"textSecondary",style:{fontWeight:"bold"}},"HTTP Proxy setup for container port: ",t.port)),e.getDialogFormBlockDomain(r,t),e.getDialogFormBlockUriPath(r,t),e.getDialogFormBlockIsSubdomain(r,t),e.getDialogFormBlockSubdomain(r,t))))})))))});return s.a.createElement("div",{className:t.sectionBlockBody},a)}},{key:"getSolutionContainerEditor",value:function(){var e=this,t=this.props.classes,a=this.state.availableContainersAnchorEl,n=this.props.containers.filter(function(t){return null==e.state._solutionParameters.find(function(e){return e.containerId==t.id})});return s.a.createElement("div",null,s.a.createElement("div",{className:t.sectionBlockHeader},s.a.createElement(se.m,{container:!0,alignItems:"center"},s.a.createElement(se.m,{item:!0,xs:!0},s.a.createElement(se.E,{gutterBottom:!0,variant:"h4"},"Containers")),s.a.createElement(se.m,{item:!0},s.a.createElement(se.b,{variant:"outlined",fullWidth:!0,disabled:0==n.length,onClick:this.onLookupContainer.bind(this)},"Lookup container"),s.a.createElement(se.v,{id:"simple-menu",anchorEl:a,open:Boolean(a),onClose:this.handleAvailableContainerMenuClose.bind(this)},n.map(function(t){return s.a.createElement(se.w,{key:"cont_mi_"+t.id,onClick:e.handleAvailableContainerMenuClose.bind(e,{cid:t.id})},t.name)})))),s.a.createElement(se.E,{color:"textSecondary"},"The docker containers that are part of the solution. Some container elements can be exposed here for user configuration as required.")),this.getSolutionContainerBlock())}},{key:"render",value:function(){var e=this,t=(this.props.classes,10);return this.props.alias&&(t-=2),this.props.solution&&(t-=4),s.a.createElement("div",null,s.a.createElement(mt,{ref:function(t){return e.formEl=t}},s.a.createElement(se.m,{container:!0,spacing:16,style:{padding:20}},s.a.createElement(se.m,{item:!0,xs:t,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"name",className:"form-control",value:this.state._name,onChange:function(t){e.setState({_name:t.target.value})},label:"Solution name",type:"text",fullWidth:!0,required:!0}),s.a.createElement("div",{className:"invalid-feedback"}))),this.props.alias&&s.a.createElement(se.m,{item:!0,xs:2,style:{textAlign:"right"}},s.a.createElement(se.E,{gutterBottom:!0,variant:"body1",style:{paddingTop:5}},"Solution alias"),s.a.createElement(se.E,{gutterBottom:!0,color:"textSecondary"},this.props.alias)),this.props.solution&&s.a.createElement(se.m,{item:!0,xs:2,style:{textAlign:"right"}},s.a.createElement(se.b,{variant:"outlined",color:"secondary",fullWidth:!0,onClick:this.props.onDeleteSolution,style:{marginTop:8}},"Delete")),s.a.createElement(se.m,{item:!0,xs:2,style:{textAlign:"right"}},s.a.createElement(se.b,{variant:"outlined",color:"primary",fullWidth:!0,onClick:this.saveSolution,style:{marginTop:8}},"Save")),this.props.solution&&s.a.createElement(se.m,{item:!0,xs:2,style:{textAlign:"right"}},s.a.createElement(se.b,{variant:"outlined",color:"primary",fullWidth:!0,onClick:this.props.exportSolution,style:{marginTop:8}},"Export")),s.a.createElement(se.m,{item:!0,xs:12,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"description",className:"form-control",value:this.state._description,onChange:function(t){e.setState({_description:t.target.value})},label:"Solution description",type:"text",multiline:!0,fullWidth:!0}))),s.a.createElement(se.m,{item:!0,xs:12},this.getSolutionContainerEditor()))),s.a.createElement(me,{show:this.state.loading,message:this.state.loadingMessage}))}}]),t}(s.a.Component),Et=Object(m.b)(function(e,t){return{domains:e.domains,settings:e.settings,containers:e.containers,nginxConfigs:e.nginxConfigs,solutions:e.solutions,solutionParameters:e.solutionParameters,nginxDockerLinks:e.nginxDockerLinks}},function(e){return{dispatch:e}})(Object(ne.withStyles)(dt)(gt)),vt=a(77),bt=a.n(vt),kt=a(66),yt=a.n(kt),St=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).handlePublicImageSwitchChange=function(e){return function(t){var n;a.setState((n={},Object(ut.a)(n,"public_di_hub_"+e,t.target.checked),Object(ut.a)(n,"public_di_zip_"+e,null),n))}},a.state={solution:null,solutionParameters:[]},a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"componentDidMount",value:function(){var e=this,t={solution:this.props.solutions.find(function(t){return t.id==e.props.solutionId})};t.solutionParameters=this.props.solutionParameters.filter(function(t){return t.solutionId==e.props.solutionId}),t.solutionParameters.forEach(function(e){t["public_di_hub_"+e.containerId]=!0,t["public_di_zip_"+e.containerId]=null}),this.setState(t)}},{key:"openFileDialog",value:function(e){c.a.findDOMNode(this.refs[e]).click()}},{key:"handleDockerfileZipSelected",value:function(e,t){if(t.target.files&&1==t.target.files.length){if("application/zip"!=t.target.files[0].type)return this.props.notify("Invalide file format, expected a ZIP file","error");this.setState(Object(ut.a)({},"public_di_zip_"+e,t.target.files[0]))}}},{key:"exportNow",value:function(){var e=Object(i.a)(r.a.mark(function e(){var t,a,n,i,o,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=new FormData,this.state)0==a.indexOf("public_di_zip_")&&t.append(a,this.state[a]);return e.prev=2,e.next=5,H.endpoints.Solutions.solutionExport(this.props.solutionId,t);case 5:return n=e.sent,e.next=8,n.blob();case 8:i=e.sent,o=window.URL.createObjectURL(i),(s=document.createElement("a")).href=o,s.download="solution.zip",document.body.appendChild(s),s.click(),s.remove(),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),this.props.notify(e.t0.message,"error");case 21:case"end":return e.stop()}},e,this,[[2,18]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.classes,a=!0;return this.state.solutionParameters.forEach(function(t){e.state["public_di_hub_"+t.containerId]||e.state["public_di_zip_"+t.containerId]||(a=!1)}),s.a.createElement(se.d,{open:!0,onClose:this.props.onDialogClose,"aria-labelledby":"form-dialog-title"},s.a.createElement(se.a,{className:t.appBar},s.a.createElement(se.D,null,s.a.createElement(Pe.a,{color:"inherit",onClick:this.props.onDialogClose,"aria-label":"Close"},s.a.createElement(Oe.a,null)),s.a.createElement(se.E,{variant:"h6",color:"inherit",className:t.flex},"Export solution"),a&&s.a.createElement(se.b,{color:"secondary",onClick:this.exportNow.bind(this)},"Export now"))),s.a.createElement(se.f,null,s.a.createElement(se.g,{style:{marginTop:20}},"If one or more containers are not available on the public Docker Hub, therefore requiering a Docker image to be build locally on the target machine, then upload the required dockerfile and it's dependencies as a zip file for each docker container of your solution."),this.state.solutionParameters.map(function(a){var n=e.props.containers.find(function(e){return e.id==a.containerId}),r=e.props.dockerImages.find(function(e){return e.id==n.dockerImageId});return s.a.createElement("div",{key:"container_i_"+a.id},s.a.createElement(se.m,{container:!0,spacing:16,style:{padding:20}},s.a.createElement(se.m,{item:!0,xs:e.state["public_di_hub_"+a.containerId]?7:4,style:{textAlign:"left"}},s.a.createElement(se.E,{variant:"subtitle2",gutterBottom:!0,style:{marginTop:17}},n.name),s.a.createElement(se.E,{variant:"caption",gutterBottom:!0,style:{marginTop:0}},"IMAGE => ",r.name+(r.version&&r.version.length>0?":"+r.version:""))),!e.state["public_di_hub_"+a.containerId]&&s.a.createElement(se.m,{item:!0,xs:3,style:{textAlign:"right"}},s.a.createElement("input",{accept:"application/zip",style:{display:"none"},type:"file",ref:"dockerfile_c_"+a.containerId,onChange:e.handleDockerfileZipSelected.bind(e,a.containerId)}),s.a.createElement("label",{htmlFor:"raised-button-file"},s.a.createElement(se.b,{variant:"contained",color:e.state["public_di_zip_"+a.containerId]?"primary":"default",className:t.uploadButton,onClick:e.openFileDialog.bind(e,"dockerfile_c_"+a.containerId)},e.state["public_di_zip_"+a.containerId]?"SELECTED":"SELECT",s.a.createElement(bt.a,{className:t.rightButtonIcon})))),s.a.createElement(se.m,{item:!0,xs:5,style:{textAlign:"right"}},s.a.createElement(se.k,{control:s.a.createElement(se.B,{checked:e.state["public_di_hub_"+a.containerId],onChange:e.handlePublicImageSwitchChange(a.containerId),value:"public_di_hub_"+a.containerId,color:"primary"}),label:"On Docker HUB"}),s.a.createElement("br",null))),s.a.createElement(yt.a,null))})))}}]),t}(s.a.Component),xt=Object(m.b)(function(e,t){return{domains:e.domains,settings:e.settings,containers:e.containers,dockerImages:e.dockerImages,nginxConfigs:e.nginxConfigs,solutions:e.solutions,solutionParameters:e.solutionParameters,nginxDockerLinks:e.nginxDockerLinks}},function(e){return{dispatch:e}})(Object(ne.withStyles)(dt)(St)),_t="prod"===a(142).environment,Ct=/([^A-Za-z0-9_]+)/,Dt=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).sharedView=null,a.handleSnackClose=function(e,t){"clickaway"!==t&&a.setState({snackOpen:!1})},a.handleSolutionMenuClick=function(e){a.state.selectedSolutionId!=e&&(null===a.state.selectedSolutionId?a.setState({selectedSolutionId:e,selectedSolutionAlias:null}):(a.setState({loading:!0,loadingMessage:null,selectedSolutionId:null,selectedSolutionAlias:null}),setTimeout(function(){a.setState({selectedSolutionId:e,loading:!1,loadingMessage:null})},500)))},a.handleNewSolutionClose=function(e){"blank"==e?(a.setState({loading:!0,loadingMessage:null,newSolutionAnchorEl:null,aliasInputDialogValueErrors:null,selectedSolutionId:null,selectedSolutionAlias:null,aliasInputDialogValue:"",targetSelect:"blank"}),setTimeout(function(){a.setState({selectedSolutionId:-1,loading:!1,loadingMessage:null})},500)):"template"==e?a.setState({newSolutionAnchorEl:null,aliasInputDialogOpen:!0,aliasInputDialogValue:"",aliasInputDialogValueErrors:null,targetSelect:"template"}):a.setState({newSolutionAnchorEl:null,aliasInputDialogOpen:!1})},a.state={newSolutionAnchorEl:null,snackOpen:!1,snackMessage:"",snackVariant:null,aliasInputDialogOpen:!1,selectedSolutionId:null,selectedSolutionAlias:null,aliasInputDialogValue:"",aliasInputDialogValueErrors:null,loading:!1,loadingMessage:null,exportSolutionWizard:!1},a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"componentDidMount",value:function(){var e=this;J.on("importStatus",function(t){"done"==t.status?Object(i.a)(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,he.reloadCoreData(e.props.dispatch);case 2:e.setState({loading:!1,loadingMessage:null}),t.hasSubdomains?e.openSnack(["Solution imported.","WARNING: One or more Ndginx configurations have a subdomain configured. You will have to specify a domain for those configurations before deploying the solution."],"warning"):e.openSnack("Solution imported.");case 4:case"end":return a.stop()}},a)}))():"message"==t.status?e.setState({loadingMessage:t.message}):"error"==t.status&&(e.setState({loading:!1,loadingMessage:null}),e.openSnack("An error occured, the solution could not be imported","error"))})}},{key:"componentWillUnmount",value:function(){J.off("importStatus")}},{key:"openSnack",value:function(e,t){this.setState({snackOpen:!0,snackMessage:e,snackVariant:t||"success"})}},{key:"renderSolutionEditor",value:function(){var e=this;if(null===this.state.selectedSolutionId)return null;var t=null;return-1!=this.state.selectedSolutionId&&(t=this.props.solutions.find(function(t){return t.id==e.state.selectedSolutionId})),s.a.createElement(Et,{solution:t,alias:t?t.alias:this.state.selectedSolutionAlias,notify:this.openSnack.bind(this),onDeleteSolution:this.deleteSolution.bind(this),exportSolution:this.exportSolution.bind(this),solutionSaved:this.afterSolutionSaved.bind(this)})}},{key:"deleteSolution",value:function(){var e=Object(i.a)(r.a.mark(function e(){var t=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:nt({title:null,message:"Are you sure you want to delete this solution?",buttons:[{label:"Yes",onClick:function(){var e=Object(i.a)(r.a.mark(function e(){var a,n,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=t.state.selectedSolutionId,t.setState({selectedSolutionId:null}),n=t.props.solutionParameters.filter(function(e){return e.solutionId==a}),i=0;case 4:if(!(i<n.length)){e.next=11;break}return e.next=7,H.endpoints.SolutionParameters.deleteById(n[i].id);case 7:t.props.dispatch({type:"DELETE_SOLUTION_PARAMETER",data:n[i].id});case 8:i++,e.next=4;break;case 11:return e.next=13,H.endpoints.Solutions.deleteById(a);case 13:t.props.dispatch({type:"DELETE_SOLUTION",data:a}),t.openSnack("Solution deleted");case 15:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{label:"No",onClick:function(){}}]});case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"afterSolutionSaved",value:function(e){this.setState({selectedSolutionId:e})}},{key:"handleNewSolutionClick",value:function(e){this.setState({newSolutionAnchorEl:e.currentTarget})}},{key:"getAliasEditorDialog",value:function(){var e=this;return s.a.createElement(se.d,{open:this.state.aliasInputDialogOpen,"aria-labelledby":"alias-form-dialog-title"},s.a.createElement(se.f,null,s.a.createElement(se.E,{color:"textSecondary"},"Specify an alias to avoid overwriting existing elements in your environement in case the solution uses similar names."),s.a.createElement(se.h,{variant:"middle",style:{marginLeft:0,marginRight:0,marginTop:20,marginBottom:20}}),s.a.createElement(se.g,null,"Solution alias name"),s.a.createElement(se.C,{autoFocus:!0,margin:"dense",type:"text",value:this.state.aliasInputDialogValue,fullWidth:!0,onChange:function(t){e.setState({aliasInputDialogValue:t.target.value.toLowerCase()})}}),this.state.aliasInputDialogValueErrors&&this.state.aliasInputDialogValueErrors.map(function(e,t){return s.a.createElement("div",{key:"err_"+t,style:{color:"red",fontSize:12}},e)})),s.a.createElement(se.e,null,s.a.createElement(se.b,{onClick:function(){return e.setState({aliasInputDialogOpen:!1})},color:"primary"},"Cancel"),s.a.createElement(se.b,{onClick:function(){0==e.state.aliasInputDialogValue.length?e.setState({aliasInputDialogValueErrors:["Required value"]}):Ct.exec(e.state.aliasInputDialogValue)?e.setState({aliasInputDialogValueErrors:["Error: alias must contain only letters, numbers or underscore."]}):e.props.solutions.find(function(t){return t.alias&&t.alias.toLowerCase()==e.state.aliasInputDialogValue.toLowerCase()})?e.setState({aliasInputDialogValueErrors:["Alias name already in use"]}):e.openImportSolutionFileDialog()},color:"secondary"},"Select ZIP")))}},{key:"exportSolution",value:function(){this.setState({exportSolutionWizard:!0})}},{key:"onSolutionExportDialogClose",value:function(){this.setState({exportSolutionWizard:!1})}},{key:"openImportSolutionFileDialog",value:function(){var e=c.a.findDOMNode(this.refs.import_input);e.value="",e.click()}},{key:"handleImportSolutionSelect",value:function(){var e=Object(i.a)(r.a.mark(function e(t){var a,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.target.files||1!=t.target.files.length){e.next=8;break}return(a=new FormData).append(this.state.aliasInputDialogValue,t.target.files[0]),this.setState({loading:!0,loadingMessage:"Importing..."}),e.next=6,H.endpoints.Solutions.solutionImport(a);case 6:if((n=e.sent).data.success)try{this.setState({newSolutionAnchorEl:null,aliasInputDialogOpen:!1}),J.socket.emit("importSolution",{uid:this.props.userSession.userId,containerBuildDirs:n.data.containerBuildDirs,solutionJsonFilePath:n.data.solutionJsonFilePath,alias:this.state.aliasInputDialogValue})}catch(r){this.setState({loading:!1,loadingMessage:null,newSolutionAnchorEl:null,aliasInputDialogOpen:!1}),this.openSnack("An error occured, could not import configuration","error")}else this.setState({loading:!1,loadingMessage:null,newSolutionAnchorEl:null,aliasInputDialogOpen:!1}),n.data.error?this.openSnack("Error occured: "+n.data.error,"error"):this.openSnack(n.data.message);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;if(!this.props.userSession.token)return s.a.createElement(ee.a,{to:"/login"});var t=this.state.newSolutionAnchorEl,a=this.props.classes,n={};return n.backgroundImage=_t?"url(/psh-admin/docker_nginx.png)":"url(/docker_nginx.png)",s.a.createElement(ge,{ref:function(t){return e.sharedView=t},history:this.props.history,pageIndex:0,notify:this.openSnack.bind(this)},s.a.createElement(se.m,{item:!0,xs:12},s.a.createElement(se.y,{className:a.configPaper},s.a.createElement(se.m,{container:!0,spacing:16},s.a.createElement(se.m,{item:!0,xs:3},s.a.createElement(se.m,{container:!0,spacing:16},s.a.createElement(se.m,{item:!0,xs:12},s.a.createElement(se.b,{variant:"contained",fullWidth:!0,"aria-owns":t?"simple-menu":void 0,"aria-haspopup":"true",onClick:this.handleNewSolutionClick.bind(this)},"New solution"),s.a.createElement(se.v,{id:"simple-menu-new-solution",anchorEl:t,open:Boolean(t),onClose:this.handleNewSolutionClose.bind(this)},s.a.createElement(se.w,{onClick:this.handleNewSolutionClose.bind(this,"blank")},s.a.createElement(se.r,{className:a.icon},s.a.createElement(st.a,null)),s.a.createElement(se.t,{inset:!0,primary:"From scratch"})),s.a.createElement(se.w,{disabled:!this.props.userSession.online,onClick:this.handleNewSolutionClose.bind(this,"template")},s.a.createElement(se.r,{className:a.icon},s.a.createElement(ct.a,null)),s.a.createElement(se.t,{inset:!0,primary:"Import"}))))),s.a.createElement(se.h,{variant:"middle",style:{marginLeft:0,marginRight:0,marginTop:10}}),s.a.createElement(se.x,null,this.props.solutions.map(function(t){return s.a.createElement(se.w,{key:"solution_menu_"+t.id,className:[a.menuItem,e.state.selectedSolutionId==t.id?a.menuItemSelected:null].join(" "),onClick:e.handleSolutionMenuClick.bind(e,t.id)},s.a.createElement(se.r,{className:a.icon},s.a.createElement(it.a,null)),s.a.createElement(se.E,{variant:"inherit",noWrap:!0},t.name))})),0==this.props.solutions.length&&s.a.createElement(se.E,{variant:"body1",style:{textAlign:"center"}},"-none-")),s.a.createElement(se.m,{item:!0,xs:9,style:null===this.state.selectedSolutionId?n:{},className:[a.viewContainer,null===this.state.selectedSolutionId?a.emptyView:null].join(" ")},this.renderSolutionEditor())))),s.a.createElement(Ge,{open:this.state.snackOpen,handleClose:this.handleSnackClose,message:this.state.snackMessage,variant:this.state.snackVariant}),this.getAliasEditorDialog(),s.a.createElement(me,{show:this.state.loading,message:this.state.loadingMessage}),s.a.createElement("input",{accept:"application/zip",style:{display:"none"},type:"file",ref:"import_input",onChange:this.handleImportSolutionSelect.bind(this)}),this.state.exportSolutionWizard&&s.a.createElement(xt,{solutionId:this.state.selectedSolutionId,notify:this.openSnack.bind(this),onDialogClose:this.onSolutionExportDialogClose.bind(this)}))}}]),t}(s.a.Component),Ot=Object(m.b)(function(e,t){return{userSession:e.userSession,solutions:e.solutions,solutionParameters:e.solutionParameters}},function(e){return{dispatch:e}})(Object(ne.withStyles)(re)(Dt)),Nt=a(41),wt=a.n(Nt),At=a(43),It=a.n(At),Tt=a(23),Pt=a.n(Tt),jt=a(42),Rt=a.n(jt),Lt=a(28),Bt=a.n(Lt),Ft=a(44),Vt=a.n(Ft),Mt=a(39),Ut=a.n(Mt),Wt=a(40),Gt=a.n(Wt),zt=a(18),Ht=a.n(zt),Kt=a(37),qt=a.n(Kt),Jt=function(e){return{paper:{padding:e.spacing.unit,position:"relative",textAlign:"left",paddingLeft:10,paddingRight:10,backgroundColor:"rgba(255, 255, 255, 0.8)"},formDiv:{padding:20,overflow:"auto",maxHeight:600},tableTitleDiv:{fontSize:28,marginTop:5,marginBottom:10,paddingRight:70},tableHeaderCell:{color:"#436dbb"},tableCell:{whiteSpace:"normal",wordWrap:"break-word"},tableCellButton:{textAlign:"right"},appBar:{position:"relative",minWidth:550},flex:{flex:1},card:{backgroundColor:"#eeeeee",overflow:"auto",maxHeight:400},cardInfo:{backgroundColor:"#ffffd1"},emptyDialogLine:{paddingLeft:30,marginTop:-15}}};function Yt(e){return s.a.createElement(qt.a,Object.assign({direction:"up"},e))}var Xt=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).SET_DATA_REDUCER_ACTION="SET_NETWORKS",a.handleDialogClose=function(){a.setSelected(null,null)},a.saveDialogData=function(){Object(i.a)(r.a.mark(function e(){var t,n,i,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.formEl.validate()){e.next=28;break}if("nginx_network"!=a.state._name.toLowerCase()&&!a.props.networks.find(function(e){return(!a.state._id||e.id!=a.state._id)&&e.name.toLowerCase()==a.state._name.toLowerCase()})){e.next=4;break}return e.abrupt("return",a.props.notify("Conflict: network name already in use.","error"));case 4:if(t=a.populateSelected(a.state),e.prev=5,"ADD"!==a.state.mode){e.next=13;break}return e.next=9,H.endpoints.Networks.create(t);case 9:n=e.sent,a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:[].concat(Object(j.a)(a.props.networks),[n])}),e.next=19;break;case 13:return t.id=a.state._id,e.next=16,H.endpoints.Networks.update(t);case 16:i=e.sent,o=a.props.networks.map(function(e){return e.id===a.state._id?i:e}),a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:o});case 19:a.setSelected(null,null),a.props.notify("Saved"),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(5),console.log("ERROR =>",e.t0),a.props.notify("An error occured, make sure the server is running.","error");case 27:case 28:case"end":return e.stop()}},e,null,[[5,23]])}))()},a.deleteDialogData=Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.props.containers.find(function(e){return-1!=e.networks.indexOf(a.state._id)})){e.next=4;break}return e.abrupt("return",a.props.notify("Conflict: this network is used by at least one container configuration.","error"));case 4:nt({title:null,message:"Are you sure you want to delete this?",buttons:[{label:"Yes",onClick:function(){var e=Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,H.endpoints.Networks.deleteById(a.state._id);case 3:a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:a.props.networks.filter(function(e){return e.id!=a.state._id})}),a.setSelected(null,null),a.props.notify("Deleted"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("ERROR =>",e.t0),a.props.notify("An error occured, make sure the server is running.","error");case 12:case"end":return e.stop()}},e,null,[[0,8]])}));return function(){return e.apply(this,arguments)}}()},{label:"No",onClick:function(){}}]});case 5:case"end":return e.stop()}},e)})),a.state=a.populateEditorFormFromObject(),a.state.selected=null,a.state.mode=null,a.tblClickDebouncer=null,a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"tableRow",value:function(e,t,a,n){var r=this;return s.a.createElement(Bt.a,{hover:!0,key:n.id,className:t?"":"hoverPointer",onClick:function(e){return r.handleRowClick(e,n.id)},selected:a&&a===n.id},s.a.createElement(Pt.a,{className:e},n.name))}},{key:"populateEditorFormFromObject",value:function(e){return{_id:e&&e.id?e.id:null,_name:e&&e.name?e.name:""}}},{key:"populateSelected",value:function(e){return{name:e._name}}},{key:"tableHeader",value:function(){return null}},{key:"generateFormContent",value:function(){var e=this;return s.a.createElement("div",{className:"form-group"},s.a.createElement(se.m,{container:!0,spacing:16},s.a.createElement(se.m,{item:!0,xs:12,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"name",className:"form-control",value:this.state._name,onChange:function(t){e.setState({_name:t.target.value})},label:"Name",type:"text",fullWidth:!0,autoFocus:!0,required:!0}),s.a.createElement("div",{className:"invalid-feedback"})))))}},{key:"setSelected",value:function(e,t){var a=this.populateEditorFormFromObject(t);a.selected=t,a.mode=e,this.setState(a)}},{key:"handleRowClick",value:function(e,t){var a=this.props.networks.find(function(e){return e.id===t});this.state.selected&&this.state._id===a.id||(this.setState({selected:null}),this.tblClickDebouncer&&clearTimeout(this.tblClickDebouncer),this.tblClickDebouncer=setTimeout(function(e){this.tblClickDebouncer=null,this.setSelected("EDIT",JSON.parse(JSON.stringify(e)))}.bind(this,a),200))}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.tableHeader();return s.a.createElement(se.y,{className:t.paper},s.a.createElement("div",{className:t.tableTitleDiv},"Networks"),s.a.createElement(se.h,{variant:"middle",style:{marginLeft:0,marginRight:0,marginTop:0,marginBottom:20}}),s.a.createElement(se.b,{variant:"contained",color:"primary",style:{textTransform:"none",position:"absolute",right:10,top:10},onClick:this.setSelected.bind(this,"ADD",{})},"New"),s.a.createElement(wt.a,{className:t.table},a&&s.a.createElement(Rt.a,null,a),s.a.createElement(It.a,null,this.props.networks.map(function(a){var n=[t.tableCell];return n=n.join(" "),e.tableRow(n,e.state.selected&&e.state.selected.id===a.id,e.state._id?e.state._id:null,a)}),0==this.props.networks.length&&s.a.createElement(Bt.a,null,s.a.createElement(Pt.a,{style:{textAlign:"center"}},s.a.createElement(Ht.a,{variant:"caption"},"-none-"))))),this.state.loading&&s.a.createElement(Vt.a,{color:"secondary"}),s.a.createElement(qe.a,{TransitionComponent:Yt,open:!!this.state.selected,onClose:this.handleDialogClose},s.a.createElement(Ut.a,{className:t.appBar},s.a.createElement(Gt.a,null,s.a.createElement(Pe.a,{color:"inherit",onClick:this.handleDialogClose,"aria-label":"Close"},s.a.createElement(Oe.a,null)),s.a.createElement(Ht.a,{variant:"h6",color:"inherit",className:t.flex},"EDIT"===this.state.mode?"Edit":"Add"," network"),s.a.createElement(se.b,{color:"inherit",onClick:this.saveDialogData},"Save"),"EDIT"===this.state.mode&&s.a.createElement(se.b,{color:"secondary",onClick:this.deleteDialogData},"Delete"))),s.a.createElement("div",{className:t.formDiv},this.state.selected&&s.a.createElement(mt,{ref:function(t){return e.formEl=t}},this.generateFormContent()))))}}]),t}(s.a.Component),Zt=(Object(m.b)(function(e,t){return{networks:e.networks,containers:e.containers}},function(e){return{dispatch:e}})(Object(ne.withStyles)(Jt)(Xt)),a(141)),$t=a.n(Zt);function Qt(e){return s.a.createElement(qt.a,Object.assign({direction:"up"},e))}var ea=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).SET_DATA_REDUCER_ACTION="SET_DOCKER_IMAGES",a.handleDialogClose=function(){a.setSelected(null,null)},a.saveDialogData=function(){Object(i.a)(r.a.mark(function e(){var t,n,i,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.formEl.validate()){e.next=35;break}if(!((t=a.populateSelected(a.state)).template&&t.template.length>0)){e.next=12;break}e.prev=4,$t.a.parse(t.template),e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(4),e.abrupt("return",a.props.notify("YAML template contains errors","error"));case 11:case 12:if(e.prev=12,"ADD"!==a.state.mode){e.next=20;break}return e.next=16,H.endpoints.DockerImages.create(t);case 16:n=e.sent,a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:[].concat(Object(j.a)(a.props.dockerImages),[n])}),e.next=26;break;case 20:return t.id=a.state._id,e.next=23,H.endpoints.DockerImages.update(t);case 23:i=e.sent,o=a.props.dockerImages.map(function(e){return e.id===a.state._id?i:e}),a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:o});case 26:a.setSelected(null,null),a.props.notify("Saved"),e.next=34;break;case 30:e.prev=30,e.t1=e.catch(12),console.log("ERROR =>",e.t1),a.props.notify("An error occured, make sure the server is running.","error");case 34:case 35:case"end":return e.stop()}},e,null,[[4,8],[12,30]])}))()},a.deleteDialogData=Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.props.containers.find(function(e){return e.dockerImageId==a.state._id})){e.next=4;break}return e.abrupt("return",a.props.notify("Conflict: this docker image is used by at least one container configuration.","error"));case 4:nt({title:null,message:"Are you sure you want to delete this?",buttons:[{label:"Yes",onClick:function(){var e=Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,H.endpoints.DockerImages.deleteById(a.state._id);case 3:a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:a.props.dockerImages.filter(function(e){return e.id!=a.state._id})}),a.setSelected(null,null),a.props.notify("Deleted"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("ERROR =>",e.t0),a.props.notify("An error occured, make sure the server is running.","error");case 12:case"end":return e.stop()}},e,null,[[0,8]])}));return function(){return e.apply(this,arguments)}}()},{label:"No",onClick:function(){}}]});case 5:case"end":return e.stop()}},e)})),a.state=a.populateEditorFormFromObject(),a.state.selected=null,a.state.mode=null,a.tblClickDebouncer=null,a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"tableRow",value:function(e,t,a,n){var r=this;return s.a.createElement(Bt.a,{hover:!0,key:n.id,className:t?"":"hoverPointer",onClick:function(e){return r.handleRowClick(e,n.id)},selected:a&&a===n.id},s.a.createElement(Pt.a,{className:e},n.name),s.a.createElement(Pt.a,{className:e},n.version))}},{key:"populateEditorFormFromObject",value:function(e){return{_id:e&&e.id?e.id:null,_name:e&&e.name?e.name:"",_version:e&&e.version?e.version:"",_template:e&&e.template?e.template:""}}},{key:"populateSelected",value:function(e){return{name:e._name,version:e._version,template:e._template}}},{key:"tableHeader",value:function(){return this.props.dockerImages.length>0?s.a.createElement(Bt.a,null,s.a.createElement(Pt.a,{className:this.props.classes.tableHeaderCell},"Image"),s.a.createElement(Pt.a,{className:this.props.classes.tableHeaderCell},"Version")):null}},{key:"generateFormContent",value:function(){var e=this;return s.a.createElement("div",{className:"form-group"},s.a.createElement(se.m,{container:!0,spacing:16},s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"name",className:"form-control",value:this.state._name,onChange:function(t){e.setState({_name:t.target.value})},label:"Name",type:"text",fullWidth:!0,autoFocus:!0,required:!0}),s.a.createElement("div",{className:"invalid-feedback"}))),s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"version",className:"form-control",value:this.state._version,onChange:function(t){e.setState({_version:t.target.value})},label:"Version",type:"text",fullWidth:!0}),s.a.createElement("div",{className:"invalid-feedback"}))),s.a.createElement(se.m,{item:!0,xs:12,style:{textAlign:"left"}},s.a.createElement(se.y,{style:{padding:10,backgroundColor:"#dddddd",marginTop:20}},s.a.createElement(Ht.a,{component:"p"},"Use the template YAML section to set default docker-compose configuration parameters for containers based on this image. ",s.a.createElement("br",null),"Any configuration element specified on the container itself will overwrite the configuration element specified in this template."))),s.a.createElement(se.m,{item:!0,xs:12,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{multiline:!0,name:"template",className:"form-control",value:this.state._template,onChange:function(t){e.setState({_template:t.target.value})},label:"Template YAML",type:"text",fullWidth:!0}),s.a.createElement("div",{className:"invalid-feedback"})))))}},{key:"setSelected",value:function(e,t){var a=this.populateEditorFormFromObject(t);a.selected=t,a.mode=e,this.setState(a)}},{key:"handleRowClick",value:function(e,t){var a=this.props.dockerImages.find(function(e){return e.id===t});this.state.selected&&this.state._id===a.id||(this.setState({selected:null}),this.tblClickDebouncer&&clearTimeout(this.tblClickDebouncer),this.tblClickDebouncer=setTimeout(function(e){this.tblClickDebouncer=null,this.setSelected("EDIT",JSON.parse(JSON.stringify(e)))}.bind(this,a),200))}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.tableHeader();return s.a.createElement(se.y,{className:t.paper},s.a.createElement("div",{className:t.tableTitleDiv},"Docker Images"),s.a.createElement(se.h,{variant:"middle",style:{marginLeft:0,marginRight:0,marginTop:0,marginBottom:20}}),s.a.createElement(se.b,{variant:"contained",color:"primary",style:{textTransform:"none",position:"absolute",right:10,top:10},onClick:this.setSelected.bind(this,"ADD",{})},"New"),s.a.createElement(wt.a,{className:t.table},a&&s.a.createElement(Rt.a,null,a),s.a.createElement(It.a,null,this.props.dockerImages.map(function(a){var n=[t.tableCell];return n=n.join(" "),e.tableRow(n,e.state.selected&&e.state.selected.id===a.id,e.state._id?e.state._id:null,a)}),0==this.props.dockerImages.length&&s.a.createElement(Bt.a,null,s.a.createElement(Pt.a,{style:{textAlign:"center"},colSpan:2},s.a.createElement(Ht.a,{variant:"caption"},"-none-"))))),this.state.loading&&s.a.createElement(Vt.a,{color:"secondary"}),s.a.createElement(qe.a,{TransitionComponent:Qt,open:!!this.state.selected,onClose:this.handleDialogClose},s.a.createElement(Ut.a,{className:t.appBar},s.a.createElement(Gt.a,null,s.a.createElement(Pe.a,{color:"inherit",onClick:this.handleDialogClose,"aria-label":"Close"},s.a.createElement(Oe.a,null)),s.a.createElement(Ht.a,{variant:"h6",color:"inherit",className:t.flex},"EDIT"===this.state.mode?"Edit":"Add"," Docker image"),s.a.createElement(se.b,{color:"inherit",onClick:this.saveDialogData},"Save"),"EDIT"===this.state.mode&&s.a.createElement(se.b,{color:"secondary",onClick:this.deleteDialogData},"Delete"))),s.a.createElement("div",{className:t.formDiv},this.state.selected&&s.a.createElement(mt,{ref:function(t){return e.formEl=t}},this.generateFormContent()))))}}]),t}(s.a.Component),ta=Object(m.b)(function(e,t){return{dockerImages:e.dockerImages,containers:e.containers}},function(e){return{dispatch:e}})(Object(ne.withStyles)(Jt)(ea)),aa=a(69),na=a.n(aa),ra=a(136),ia=a.n(ra),oa=a(137),sa=a.n(oa),la=a(135),ca=a.n(la),ua=a(70),da=a.n(ua),ma=a(34),pa=a.n(ma),ha=a(61),fa=a.n(ha),ga=a(64),Ea=a.n(ga),va=a(67),ba=a.n(va),ka=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).handleClickButton=function(e){if(e){if(a.formEl.validate()){(a.props.containerPath.length>0?a.props.currentVolumes.find(function(e){return e.containerPath!=a.props.containerPath&&a.state.containerPath==e.containerPath}):a.props.currentVolumes.find(function(e){return a.state.containerPath==e.containerPath}))?a.props.onDuplicate():(a.props.onSubmit({hostPath:a.state.hostPath,volumeDescription:a.state.volumeDescription,containerPath:a.state.containerPath,git:a.state.git,cmd:a.state.cmd,execOnEveryDeploy:a.state.execOnEveryDeploy}),a.close())}}else a.close()},a.close=function(){!function(){var e=document.getElementById("react-volume-dialog");Object(l.unmountComponentAtNode)(e),e.parentNode.removeChild(e)}()},a.keyboardClose=function(e){27===e.keyCode&&a.close()},a.componentDidMount=function(){document.addEventListener("keydown",a.keyboardClose,!1),a.setState({hostPath:a.props.hostPath,volumeDescription:a.props.volumeDescription,containerPath:a.props.containerPath,git:a.props.git,cmd:a.props.cmd,execOnEveryDeploy:a.props.execOnEveryDeploy})},a.componentWillUnmount=function(){document.removeEventListener("keydown",a.keyboardClose,!1),a.props.willUnmount()},a.state={hostPath:"",volumeDescription:"",containerPath:"",execOnEveryDeploy:!1,git:"",cmd:""},a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement(qe.a,{open:!0,onClose:this.close,"aria-labelledby":"volume-dialog-title","aria-describedby":"volume-dialog-description"},s.a.createElement(tt.a,{id:"volume-dialog-title"},"Volume configuration"),s.a.createElement(Ze.a,null,s.a.createElement(Qe.a,{id:"volume-dialog-description"},"You can optionally specify a GIT repository for this volume, in which case the repo will be cloned inside this volume if it does not exist on deploy."),s.a.createElement(mt,{ref:function(t){return e.formEl=t}},s.a.createElement(pa.a,{container:!0,alignItems:"center",style:{marginTop:20}},s.a.createElement(pa.a,{item:!0,xs:12},s.a.createElement("div",{className:"form-group",style:{marginRight:10}},s.a.createElement(da.a,{autoFocus:!0,margin:"dense",label:"Container volume description",type:"text",value:this.state.volumeDescription,onChange:function(t){e.setState({volumeDescription:t.target.value})},fullWidth:!0}),s.a.createElement("div",{className:"invalid-feedback"}))),s.a.createElement(pa.a,{item:!0,xs:!0},s.a.createElement("div",{className:"form-group",style:{marginRight:10}},s.a.createElement(da.a,{required:!0,margin:"dense",label:"Host volume path",type:"text",value:this.state.hostPath,onChange:function(t){e.setState({hostPath:t.target.value})},fullWidth:!0}),s.a.createElement("div",{className:"invalid-feedback"}))),s.a.createElement(pa.a,{item:!0,xs:!0},s.a.createElement("div",{className:"form-group",style:{marginLeft:10}},s.a.createElement(da.a,{required:!0,margin:"dense",label:"Container path",type:"text",value:this.state.containerPath,onChange:function(t){e.setState({containerPath:t.target.value})},fullWidth:!0}),s.a.createElement("div",{className:"invalid-feedback"})))),s.a.createElement(yt.a,{style:{marginTop:40,marginBottom:10}}),s.a.createElement(pa.a,{container:!0,alignItems:"center"},s.a.createElement(pa.a,{item:!0,xs:!0},s.a.createElement("div",{className:"form-group"},s.a.createElement(da.a,{margin:"dense",label:"Git repo (optional)",type:"text",value:this.state.git,onChange:function(t){e.setState({git:t.target.value})},fullWidth:!0}),s.a.createElement("div",{className:"invalid-feedback"})))),this.state.git.length>0&&s.a.createElement(pa.a,{container:!0,alignItems:"center"},s.a.createElement(pa.a,{item:!0,xs:!0},s.a.createElement("div",{className:"form-group",style:{marginRight:10}},s.a.createElement(da.a,{margin:"dense",label:"Execute command after clone",type:"text",value:this.state.cmd,onChange:function(t){e.setState({cmd:t.target.value})},fullWidth:!0}),s.a.createElement("div",{className:"invalid-feedback"}))),s.a.createElement(pa.a,{item:!0,xs:!0},s.a.createElement(Ea.a,{row:!0,style:{marginLeft:10}},s.a.createElement(ba.a,{control:s.a.createElement(fa.a,{checked:this.state.execOnEveryDeploy,onChange:function(t){e.setState({execOnEveryDeploy:t.target.checked})}}),label:"Pull and execute command on every deploy"})))))),s.a.createElement(Ye.a,null,s.a.createElement(He.a,{onClick:function(){return e.handleClickButton(!0)}},this.props.submitLabel),s.a.createElement(He.a,{onClick:function(){return e.handleClickButton()}},"Cancel")))}}]),t}(s.a.Component);function ya(e){!function(e){var t=document.getElementById("react-volume-dialog");t?Object(l.render)(s.a.createElement(ka,e),t):(document.body.children[0].classList.add("react-volume-dialog-blur"),(t=document.createElement("div")).id="react-volume-dialog",document.body.appendChild(t),Object(l.render)(s.a.createElement(ka,e),t))}(e)}ka.defaultProps={buttons:[{label:"Cancel",onClick:function(){return null}},{label:"Confirm",onClick:function(){return null}}],willUnmount:function(){return null}};var Sa=/([^A-Za-z0-9_]+)/,xa=/(\d{1,5}:{1,5})/,_a=/(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}/,Ca=/(^([^=]+=[^;]+;)*([^=]+=[^;]+;?))/;function Da(e){return s.a.createElement(qt.a,Object.assign({direction:"up"},e))}var Oa={PaperProps:{style:{maxHeight:224,width:250}}},Na=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).SET_DATA_REDUCER_ACTION="SET_CONTAINERS",a.handleDialogClose=function(){a.setSelected(null,null)},a.saveDialogData=function(){Object(i.a)(r.a.mark(function e(){var t,n,i,o,s,l,c,u;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.formEl.validate()){e.next=62;break}if(!Sa.exec(a.state._name)){e.next=4;break}return e.abrupt("return",a.props.notify("Error: Container name must contain only letters, numbers or underscore.","error"));case 4:if(!a.props.containers.find(function(e){return(!a.state._id||e.id!=a.state._id)&&e.name.toLowerCase()==a.state._name.toLowerCase()})){e.next=8;break}return e.abrupt("return",a.props.notify("Conflict: container name already in use.","error"));case 8:if(!a.state._id){e.next=13;break}if(t=!1,a.state._dependsOn.find(function(e){a.props.containers.filter(function(e){return e.id!=a.state._id}).find(function(e){return e.dependsOn&&e.dependsOn.find(function(e){return e==a.state._id})})&&(t=!0)}),!t){e.next=13;break}return e.abrupt("return",a.props.notify("Conflict: this container is dependent on a container that is itself dependant on this container.","error"));case 13:if(n=a.populateSelected(a.state),e.prev=14,"ADD"!==a.state.mode){e.next=30;break}return e.next=18,H.endpoints.Containers.create(n);case 18:i=e.sent,o=0;case 20:if(!(o<a.state._networks.length)){e.next=26;break}return e.next=23,H.endpoints.Containers.linkRelation(i.id,"networks",a.state._networks[o],{containerId:i.id,networkId:a.state._networks[o]});case 23:o++,e.next=20;break;case 26:i.networks=a.state._networks,a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:[].concat(Object(j.a)(a.props.containers),[i])}),e.next=53;break;case 30:return n.id=a.state._id,e.next=33,H.endpoints.Containers.update(n);case 33:s=e.sent,l=0;case 35:if(!(l<a.state.selected.networks.length)){e.next=42;break}if(-1!=a.state._networks.indexOf(a.state.selected.networks[l])){e.next=39;break}return e.next=39,H.endpoints.Containers.unlinkRelation(a.state._id,"networks",a.state.selected.networks[l]);case 39:l++,e.next=35;break;case 42:c=0;case 43:if(!(c<a.state._networks.length)){e.next=50;break}if(-1!=a.state.selected.networks.indexOf(a.state._networks[c])){e.next=47;break}return e.next=47,H.endpoints.Containers.linkRelation(a.state._id,"networks",a.state._networks[c],{containerId:a.state._id,networkId:a.state._networks[c]});case 47:c++,e.next=43;break;case 50:s.networks=a.state._networks,u=a.props.containers.map(function(e){return e.id===a.state._id?s:e}),a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:u});case 53:a.setSelected(null,null),a.props.notify("Saved"),e.next=61;break;case 57:e.prev=57,e.t0=e.catch(14),console.log("ERROR =>",e.t0),a.props.notify("An error occured, make sure the server is running.","error");case 61:case 62:case"end":return e.stop()}},e,null,[[14,57]])}))()},a.deleteDialogData=Object(i.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.state.selected.id){e.next=4;break}if(!((t=a.props.nginxDockerLinks.filter(function(e){return e.containerId==a.state.selected.id}).map(function(e){return e.nginxConfigId})).length>0)){e.next=4;break}return e.abrupt("return",a.props.notify("Conflict: this container configuration is in use by NGinx configs '".concat(a.props.nginxConfigs.filter(function(e){return-1!=t.indexOf(e.id)}).map(function(e){return e.name}).join(", "),"'"),"error"));case 4:a.props.containers.filter(function(e){return e.id!=a.state._id}).find(function(e){return e.dependsOn&&e.dependsOn.find(function(e){return e==a.state._id})})?a.props.notify("Conflict: Cannot delete because there is a container that flagged this container as a dependency.","error"):nt({title:null,message:"Are you sure you want to delete this?",buttons:[{label:"Yes",onClick:function(){var e=Object(i.a)(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=a.props.solutionParameters.filter(function(e){return e.containerId==a.state._id}),n=0;case 3:if(!(n<t.length)){e.next=10;break}return e.next=6,H.endpoints.SolutionParameters.deleteById(t[n].id);case 6:a.props.dispatch({type:"DELETE_SOLUTION_PARAMETER",data:t[n].id});case 7:n++,e.next=3;break;case 10:return e.next=12,H.endpoints.Containers.deleteById(a.state._id);case 12:a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:a.props.containers.filter(function(e){return e.id!=a.state._id})}),a.setSelected(null,null),a.props.notify("Deleted"),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),console.log("ERROR =>",e.t0),a.props.notify("An error occured, make sure the server is running.","error");case 21:case"end":return e.stop()}},e,null,[[0,17]])}));return function(){return e.apply(this,arguments)}}()},{label:"No",onClick:function(){}}]});case 5:case"end":return e.stop()}},e)})),a.state=a.populateEditorFormFromObject(),a.state.selected=null,a.state.mode=null,a.state.loading=!1,a.state.loadingMessage=null,a.state.inputDialogOpen=!1,a.state.inputDialogLabel="",a.state.inputDialogTarget="",a.state.inputDialogValue="",a.state.inputDialogKey="",a.state.inputDialogValueErrors=null,a.state.containerStatuses=null,a.state.actionDialogOpen=!1,a.state.actionDialogAnchor=null,a.tblClickDebouncer=null,a.tblButtonEventSource=null,a.containerStatusUpdateInterval=null,a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"componentDidMount",value:function(){var e=this;J.on("containerStatus",function(t){"done"==t.status?e.setState({containerStatuses:t.containerStatus}):e.setState({containerStatuses:null}),1==e.state.loading&&e.setState({loading:!1,loadingMessage:null})}),J.socket.emit("getContainerStatus",{uid:this.props.userSession.userId}),this.containerStatusUpdateInterval=setInterval(function(){J.socket.emit("getContainerStatus",{uid:e.props.userSession.userId})},6e4)}},{key:"componentWillUnmount",value:function(){J.off("containerStatus"),clearInterval(this.containerStatusUpdateInterval),this.containerStatusUpdateInterval=null}},{key:"handleStop",value:function(e){var t=this;this.setState({actionDialogOpen:!1}),Object(i.a)(r.a.mark(function a(){var n;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.setState({loading:!0,loadingMessage:"Stopping service..."}),a.next=3,H.endpoints.Containers.remote("stop",null,"POST",{id:e,uid:t.props.userSession.userId});case 3:if(!(n=a.sent).data.success){a.next=8;break}return a.abrupt("return",t.props.notify("Container stopped","info"));case 8:return a.abrupt("return",t.props.notify(n.data.error,"error"));case 9:case"end":return a.stop()}},a)}))(),setTimeout(function(){t.tblButtonEventSource=null},100)}},{key:"handleStart",value:function(e){var t=this;this.setState({actionDialogOpen:!1}),Object(i.a)(r.a.mark(function a(){var n;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.setState({loading:!0,loadingMessage:"Starting service..."}),a.next=3,H.endpoints.Containers.remote("start",null,"POST",{id:e,uid:t.props.userSession.userId});case 3:if(!(n=a.sent).data.success){a.next=8;break}return a.abrupt("return",t.props.notify("Container started","info"));case 8:return a.abrupt("return",t.props.notify(n.data.error,"error"));case 9:case"end":return a.stop()}},a)}))(),setTimeout(function(){t.tblButtonEventSource=null},100)}},{key:"handleRestart",value:function(e){var t=this;this.setState({actionDialogOpen:!1}),Object(i.a)(r.a.mark(function a(){var n;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.setState({loading:!0,loadingMessage:"Restarting service..."}),a.next=3,H.endpoints.Containers.remote("restart",null,"POST",{id:e,uid:t.props.userSession.userId});case 3:if(!(n=a.sent).data.success){a.next=8;break}return a.abrupt("return",t.props.notify("Container restarted","info"));case 8:return a.abrupt("return",t.props.notify(n.data.error,"error"));case 9:case"end":return a.stop()}},a)}))(),setTimeout(function(){t.tblButtonEventSource=null},100)}},{key:"handleEnable",value:function(e,t){var a=this;console.log(t),this.setState({actionDialogOpen:!1}),Object(i.a)(r.a.mark(function n(){var i;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,H.endpoints.Containers.remote("toggleEnabled",null,"POST",{enabled:!e,id:t});case 2:if(!(i=n.sent).data.success){n.next=7;break}a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:a.props.containers.map(function(a){return a.id==t&&(a.enabled=!e),a})}),n.next=8;break;case 7:return n.abrupt("return",a.props.notify(i.data.error,"error"));case 8:case"end":return n.stop()}},n)}))(),setTimeout(function(){a.tblButtonEventSource=null},100)}},{key:"tableRow",value:function(e,t,a,n){var r=this,i=this.props.dockerImages.find(function(e){return e.id==n.dockerImageId}),o=this.state.containerStatuses?this.state.containerStatuses.find(function(e){return e.name=="psh_"+n.name}):null,l=!!o&&"UP"==o.state;return s.a.createElement(Bt.a,{hover:!0,key:n.id,className:t?"":"hoverPointer",onClick:function(e){r.handleRowClick(e,n.id)},selected:a&&a===n.id},s.a.createElement(Pt.a,{className:e},n.name),s.a.createElement(Pt.a,{className:e},"".concat(this.props.dockerImages.find(function(e){return e.id==n.dockerImageId}).name).concat(i.version.length>0?":"+i.version:"")),s.a.createElement(Pt.a,{className:e,style:{width:30}},n.enabled?"Yes":"No"),s.a.createElement(Pt.a,{className:e,style:{width:30}},this.state.containerStatuses?l?"Up":"Down":"n/a"),s.a.createElement(Pt.a,{className:e,style:{textAlign:"right"},component:"th",scope:"row"},s.a.createElement(se.n,{onClick:function(e){r.tblButtonEventSource="BTN",r.setState({actionDialogOpen:!0,actionDialogAnchor:e.currentTarget})}},s.a.createElement(ca.a,null)),s.a.createElement(se.v,{id:"simple-menu-"+n.id,anchorEl:this.state.actionDialogAnchor,keepMounted:!0,open:this.state.actionDialogOpen,onClose:function(){r.setState({actionDialogOpen:!1}),setTimeout(function(){r.tblButtonEventSource=null},100)}},s.a.createElement(se.w,{onClick:this.handleEnable.bind(this,n.enabled,n.id)},n.enabled?"Disable container":"Enable container"),this.state.containerStatuses&&l&&s.a.createElement(se.w,{onClick:this.handleStop.bind(this,n.id)},"Stop"),this.state.containerStatuses&&l&&s.a.createElement(se.w,{onClick:this.handleRestart.bind(this,n.id)},"Restart"),this.state.containerStatuses&&!l&&s.a.createElement(se.w,{onClick:this.handleStart.bind(this,n.id)},"Start"))))}},{key:"populateEditorFormFromObject",value:function(e){return{_id:e&&e.id?e.id:null,_name:e&&e.name?e.name:"",_networks:e&&e.networks?e.networks:[],_dependsOn:e&&e.dependsOn?e.dependsOn:[],_dockerImageId:e&&e.dockerImageId?e.dockerImageId:"",_env:e&&e.env?e.env:[],_ports:e&&e.ports?e.ports:[],_command:e&&e.command?e.command:"",_user:e&&e.user?e.user:"",_workingDir:e&&e.workingDir?e.workingDir:"",_volumes:e&&e.volumes?e.volumes:[],_dns:e&&e.dns?e.dns:[]}}},{key:"populateSelected",value:function(e){return{name:e._name,dockerImageId:e._dockerImageId,env:e._env,dependsOn:e._dependsOn,ports:e._ports,command:e._command,user:e._user,workingDir:e._workingDir,volumes:e._volumes,dns:e._dns}}},{key:"tableHeader",value:function(){return this.props.containers.length>0?s.a.createElement(Bt.a,null,s.a.createElement(Pt.a,{className:this.props.classes.tableHeaderCell},"Name"),s.a.createElement(Pt.a,{className:this.props.classes.tableHeaderCell},"Image"),s.a.createElement(Pt.a,{className:this.props.classes.tableHeaderCell},"Enabled"),s.a.createElement(Pt.a,{className:this.props.classes.tableHeaderCell},"State")):null}},{key:"setSelected",value:function(e,t){if(t&&!t.id&&0==this.props.dockerImages.length)return this.props.notify("No docker images available","error");var a=this.populateEditorFormFromObject(t);a.selected=t,a.mode=e,this.setState(a)}},{key:"handleRowClick",value:function(e,t){if("BTN"!=this.tblButtonEventSource){var a=this.props.containers.find(function(e){return e.id===t});this.state.selected&&this.state._id===a.id||(this.setState({selected:null}),this.tblClickDebouncer&&clearTimeout(this.tblClickDebouncer),this.tblClickDebouncer=setTimeout(function(e){this.tblClickDebouncer=null,this.setSelected("EDIT",JSON.parse(JSON.stringify(e)))}.bind(this,a),200))}}},{key:"stringEditorDialog",value:function(e,t,a){var n=this;return s.a.createElement(qe.a,{open:this.state.inputDialogOpen,onClose:t.bind(this,"CANCEL"),"aria-labelledby":"form-dialog-title"},s.a.createElement(se.f,null,e&&s.a.createElement(se.g,null,e),s.a.createElement(se.C,{autoFocus:!0,margin:"dense",label:this.state.inputDialogLabel,type:"text",value:this.state.inputDialogValue,onChange:function(e){n.setState({inputDialogValue:e.target.value})},style:{width:500}}),this.state.inputDialogValueErrors&&this.state.inputDialogValueErrors.map(function(e,t){return s.a.createElement("div",{key:"err_"+t,style:{color:"red",fontSize:12}},e)})),s.a.createElement(se.e,null,s.a.createElement(se.b,{onClick:t.bind(this,"CANCEL"),color:"primary"},"Cancel"),s.a.createElement(se.b,{onClick:function(){if(a){var e=a(n.state.inputDialogValue);e?n.setState({inputDialogValueErrors:e}):t("SAVE")}else t("SAVE")},color:"primary"},"Save")))}},{key:"getDialogFormBlockName",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"name",className:"form-control",value:this.state._name,onChange:function(t){e.setState({_name:t.target.value})},label:"Container name",type:"text",fullWidth:!0,autoFocus:!0,required:!0}),s.a.createElement("div",{className:"invalid-feedback"})))}},{key:"getDialogFormBlockCommand",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"command",className:"form-control",value:this.state._command,onChange:function(t){e.setState({_command:t.target.value})},label:"Command",type:"text",fullWidth:!0}),s.a.createElement("div",{className:"invalid-feedback"})))}},{key:"getDialogFormBlockUser",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"user",className:"form-control",value:this.state._user,onChange:function(t){e.setState({_user:t.target.value})},label:"User",type:"text",fullWidth:!0}),s.a.createElement("div",{className:"invalid-feedback"})))}},{key:"getDialogFormBlockWorkingDir",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"workingDir",className:"form-control",value:this.state._workingDir,onChange:function(t){e.setState({_workingDir:t.target.value})},label:"Working directory",type:"text",fullWidth:!0}),s.a.createElement("div",{className:"invalid-feedback"})))}},{key:"getDialogFormBlockNetworks",value:function(){var e=this,t=this.props.networks.map(function(e){return e.name});return s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"left"}},t.length>0&&s.a.createElement("div",{className:"form-group",style:{textAlign:"left"}},s.a.createElement(se.j,{fullWidth:!0},s.a.createElement(se.o,{htmlFor:"networks"},"Networks"),s.a.createElement(se.z,{multiple:!0,value:this.state._networks,onChange:function(t){e.setState(Object(ut.a)({},t.target.name,t.target.value))},renderValue:function(t){return e.props.networks.filter(function(e){return t.indexOf(e.id)>-1}).map(function(e){return e.name}).join(", ")},inputProps:{name:"_networks",id:"networks"},MenuProps:Oa,fullWidth:!0},t.map(function(t){return s.a.createElement(se.w,{key:t,value:e.props.networks.find(function(e){return e.name==t}).id},s.a.createElement(se.c,{checked:e.props.networks.filter(function(t){return e.state._networks.indexOf(t.id)>-1}).map(function(e){return e.name}).indexOf(t)>-1}),s.a.createElement(se.t,{primary:t}))})))))}},{key:"getDialogFormBlockDependsOn",value:function(){var e=this,t=this.props.containers.filter(function(t){return t.id!=e.state.selected.id});return s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"left"}},t.length>0&&s.a.createElement("div",{className:"form-group",style:{textAlign:"left"}},s.a.createElement(se.j,{fullWidth:!0},s.a.createElement(se.o,{htmlFor:"_dependsOn"},"Depends on"),s.a.createElement(se.z,{multiple:!0,value:this.state._dependsOn,onChange:function(t){e.setState(Object(ut.a)({},t.target.name,t.target.value))},renderValue:function(t){return e.state._dependsOn?e.state._dependsOn.map(function(t){return e.props.containers.find(function(e){return e.id==t}).name}).join(", "):""},inputProps:{name:"_dependsOn",id:"_dependsOn"},MenuProps:Oa,fullWidth:!0},t.map(function(t){return s.a.createElement(se.w,{key:t.name,value:t.id},s.a.createElement(se.c,{checked:!!e.state._dependsOn.find(function(e){return e==t.id})}),s.a.createElement(se.t,{primary:t.name}))})))))}},{key:"getDialogFormBlockDockerImages",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group",style:{textAlign:"left"}},s.a.createElement(se.j,{fullWidth:!0},s.a.createElement(se.o,{htmlFor:"dockerImage"},"Docker Image"),s.a.createElement(se.z,{required:!0,value:this.state._dockerImageId,onChange:function(t){var a=e.props.dockerImages.find(function(e){return e.id==t.target.value}),n=Object(ut.a)({},t.target.name,t.target.value);if(a.template&&a.template.length>0){var r=$t.a.parse(a.template);if(r.ports&&(n._ports=r.ports),r.environment&&(n._env=r.environment),r.dns&&(n._dns=r.dns),r.volumes&&(n._volumes=r.volumes.map(function(e){return{hostPath:e.substring(0,e.indexOf(":")),containerPath:e.substring(e.indexOf(":")+1),git:"",cmd:""}})),r.networks){var i=r.networks.map(function(t){return e.props.networks.find(function(e){return e.name==t})?e.props.networks.find(function(e){return e.name==t}).id:null});n._networks=i.filter(function(e){return null!=e})}if(r.depends_on){var o=r.depends_on.map(function(t){return e.props.containers.find(function(e){return e.name==t})?t:null});n._dependsOn=o.filter(function(e){return null!=e})}r.working_dir&&(n._workingDir=r.working_dir),r.command&&(n._command=r.command),r.user&&(n._user=r.user)}e.setState(n)},inputProps:{name:"_dockerImageId",id:"_dockerImageId"}},this.props.dockerImages.map(function(e){return s.a.createElement(se.w,{key:e.id,value:e.id},e.name+(e.version.length>0?":"+e.version:""))})),s.a.createElement("div",{className:"invalid-feedback"}))))}},{key:"getDialogFormBlockEnvironementVariables",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:12,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group",style:{textAlign:"left"}},s.a.createElement(se.m,{container:!0},s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"left"}},s.a.createElement(se.u,{component:"div"},"Environement Variables")),s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"right"}},s.a.createElement(se.b,{color:"primary",style:{marginTop:8},onClick:function(t){e.setState({inputDialogOpen:!0,inputDialogValue:"",inputDialogValueErrors:null,inputDialogTarget:"env",inputDialogLabel:"Environement Variable (<NAME>=<VALUE>)",inputDialogKey:null})}},"Add Env"))),s.a.createElement(se.p,{dense:!1},this.state._env.map(function(t,a){return s.a.createElement(se.q,{key:"env_"+a,button:!0,onClick:function(e,t){this.setState({inputDialogOpen:!0,inputDialogValue:e,inputDialogValueErrors:null,inputDialogTarget:"env",inputDialogLabel:"Environement Variable (<NAME>=<VALUE>)",inputDialogKey:t})}.bind(e,t,a)},s.a.createElement(na.a,null),s.a.createElement(se.t,{primary:t,secondary:null}),s.a.createElement(se.s,{onClick:function(e){this.state._env.splice(e,1),this.setState({_env:this.state._env})}.bind(e,a)},s.a.createElement(se.n,{"aria-label":"Delete"},s.a.createElement(ht.a,null))))}),0==this.state._env.length&&s.a.createElement(Ht.a,{variant:"caption",className:this.props.classes.emptyDialogLine},"-none-"))))}},{key:"getDialogFormBlockVolumes",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:12,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group",style:{textAlign:"left"}},s.a.createElement(se.m,{container:!0},s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"left"}},s.a.createElement(se.u,{component:"div"},"Volumes")),s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"right"}},s.a.createElement(se.b,{color:"primary",style:{marginTop:8},onClick:function(t){ya({submitLabel:"Add",volumeDescription:"",hostPath:"",containerPath:"",git:"",cmd:"",execOnEveryDeploy:!1,currentVolumes:e.state._volumes,onDuplicate:function(){e.props.notify("This container volume already exists","error")},onSubmit:function(){var t=Object(i.a)(r.a.mark(function t(a){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.state._volumes.push(a),e.setState({_volumes:e.state._volumes});case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()})}},"Add Volume"))),s.a.createElement(se.p,{dense:!1},this.state._volumes.map(function(t,a){return s.a.createElement(se.q,{key:"volume_"+a,button:!0,onClick:function(e,t){var a=this;ya({submitLabel:"Set",hostPath:e.hostPath,volumeDescription:e.volumeDescription?e.volumeDescription:"",containerPath:e.containerPath,git:e.git,cmd:e.cmd,execOnEveryDeploy:!!e.execOnEveryDeploy,currentVolumes:this.state._volumes,onDuplicate:function(){a.props.notify("This container volume already exists","error")},onSubmit:function(){var e=Object(i.a)(r.a.mark(function e(t,a){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.state._volumes=this.state._volumes.map(function(e){return e.containerPath==t?a:e}),this.setState({_volumes:this.state._volumes});case 2:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}().bind(this,e.containerPath)})}.bind(e,t,a)},s.a.createElement(ia.a,null),s.a.createElement(se.t,{primary:t.hostPath,secondary:t.containerPath}),s.a.createElement(se.s,{onClick:function(e){this.state._volumes.splice(e,1),this.setState({_volumes:this.state._volumes})}.bind(e,a)},s.a.createElement(se.n,{"aria-label":"Delete"},s.a.createElement(ht.a,null))))}),0==this.state._volumes.length&&s.a.createElement(Ht.a,{variant:"caption",className:this.props.classes.emptyDialogLine},"-none-"))))}},{key:"getDialogFormBlockDns",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:12,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group",style:{textAlign:"left"}},s.a.createElement(se.m,{container:!0},s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"left"}},s.a.createElement(se.u,{component:"div"},"DNS's")),s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"right"}},s.a.createElement(se.b,{color:"primary",style:{marginTop:8},onClick:function(t){e.setState({inputDialogOpen:!0,inputDialogValue:"",inputDialogValueErrors:null,inputDialogTarget:"dns",inputDialogLabel:"DNS",inputDialogKey:null})}},"Add DNS"))),s.a.createElement(se.p,{dense:!1},this.state._dns.map(function(t,a){return s.a.createElement(se.q,{key:"dns_"+a,button:!0,onClick:function(e,t){this.setState({inputDialogOpen:!0,inputDialogValue:e,inputDialogValueErrors:null,inputDialogTarget:"dns",inputDialogLabel:"DNS",inputDialogKey:t})}.bind(e,t,a)},s.a.createElement(sa.a,null),s.a.createElement(se.t,{primary:t,secondary:null}),s.a.createElement(se.s,{onClick:function(e){this.state._dns.splice(e,1),this.setState({_dns:this.state._dns})}.bind(e,a)},s.a.createElement(se.n,{"aria-label":"Delete"},s.a.createElement(ht.a,null))))}),0==this.state._dns.length&&s.a.createElement(Ht.a,{variant:"caption",className:this.props.classes.emptyDialogLine},"-none-"))))}},{key:"getDialogFormBlockPorts",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:12,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group",style:{textAlign:"left"}},s.a.createElement(se.m,{container:!0},s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"left"}},s.a.createElement(se.u,{component:"div"},"Ports")),s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"right"}},s.a.createElement(se.b,{color:"primary",style:{marginTop:8},onClick:function(t){e.setState({inputDialogOpen:!0,inputDialogValue:"",inputDialogValueErrors:null,inputDialogTarget:"port",inputDialogLabel:"Port mapping (<HOST>:<CONTAINER>)",inputDialogKey:null})}},"Add Port"))),s.a.createElement(se.p,{dense:!1},this.state._ports.map(function(t,a){return s.a.createElement(se.q,{key:"port_"+a,button:!0,onClick:function(e,t){this.setState({inputDialogOpen:!0,inputDialogValue:e,inputDialogValueErrors:null,inputDialogTarget:"port",inputDialogLabel:"Port mapping (<HOST>:<CONTAINER>)",inputDialogKey:t})}.bind(e,t,a)},s.a.createElement(na.a,null),s.a.createElement(se.t,{primary:t,secondary:null}),s.a.createElement(se.s,{onClick:function(e){this.state._ports.splice(e,1),this.setState({_ports:this.state._ports})}.bind(e,a)},s.a.createElement(se.n,{"aria-label":"Delete"},s.a.createElement(ht.a,null))))}),0==this.state._ports.length&&s.a.createElement(Ht.a,{variant:"caption",className:this.props.classes.emptyDialogLine},"-none-"))))}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.tableHeader();return s.a.createElement(se.y,{className:t.paper},s.a.createElement("div",{className:t.tableTitleDiv},"Containers"),s.a.createElement(se.h,{variant:"middle",style:{marginLeft:0,marginRight:0,marginTop:0,marginBottom:20}}),s.a.createElement(se.b,{variant:"contained",color:"primary",style:{textTransform:"none",position:"absolute",right:10,top:10},onClick:this.setSelected.bind(this,"ADD",{})},"New"),s.a.createElement(wt.a,{className:t.table},a&&s.a.createElement(Rt.a,null,a),s.a.createElement(It.a,null,this.props.containers.map(function(a){var n=[t.tableCell];return n=n.join(" "),e.tableRow(n,e.state.selected&&e.state.selected.id===a.id,e.state._id?e.state._id:null,a)}),0==this.props.containers.length&&s.a.createElement(Bt.a,null,s.a.createElement(Pt.a,{style:{textAlign:"center"},colSpan:2},s.a.createElement(Ht.a,{variant:"caption"},"-none-"))))),this.state.loading&&s.a.createElement(Vt.a,{color:"secondary"}),s.a.createElement(qe.a,{TransitionComponent:Da,open:!!this.state.selected,onClose:this.handleDialogClose},s.a.createElement(Ut.a,{className:t.appBar},s.a.createElement(Gt.a,null,s.a.createElement(se.n,{color:"inherit",onClick:this.handleDialogClose,"aria-label":"Close"},s.a.createElement(Oe.a,null)),s.a.createElement(Ht.a,{variant:"h6",color:"inherit",className:t.flex},"EDIT"===this.state.mode?"Edit":"Add"," container"),s.a.createElement(se.b,{color:"inherit",onClick:this.saveDialogData},"Save"),"EDIT"===this.state.mode&&s.a.createElement(se.b,{color:"secondary",onClick:this.deleteDialogData},"Delete"))),s.a.createElement("div",{className:t.formDiv},this.state.selected&&s.a.createElement(mt,{ref:function(t){return e.formEl=t}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.m,{container:!0,spacing:16},this.getDialogFormBlockName(),this.getDialogFormBlockDockerImages(),this.getDialogFormBlockCommand(),this.getDialogFormBlockUser(),this.getDialogFormBlockWorkingDir(),this.props.containers.length>0&&this.getDialogFormBlockDependsOn(),this.getDialogFormBlockVolumes(),this.getDialogFormBlockDns(),this.getDialogFormBlockEnvironementVariables(),this.getDialogFormBlockPorts()))))),this.stringEditorDialog(null,function(t){switch(t+"_"+e.state.inputDialogTarget){case"SAVE_env":null!=e.state.inputDialogKey?(e.state._env[e.state.inputDialogKey]=e.state.inputDialogValue,e.setState({_env:e.state._env})):(e.state._env.push(e.state.inputDialogValue),e.setState({_env:e.state._env}));break;case"SAVE_port":null!=e.state.inputDialogKey?(e.state._ports[e.state.inputDialogKey]=e.state.inputDialogValue,e.setState({_ports:e.state._ports})):(e.state._ports.push(e.state.inputDialogValue),e.setState({_ports:e.state._ports}));break;case"SAVE_dns":null!=e.state.inputDialogKey?(e.state._dns[e.state.inputDialogKey]=e.state.inputDialogValue,e.setState({_dns:e.state._dns})):(e.state._dns.push(e.state.inputDialogValue),e.setState({_dns:e.state._dns}))}e.setState({inputDialogOpen:!1})},function(t){switch(e.state.inputDialogTarget){case"env":return Ca.exec(t)?(e.state.inputDialogKey,null):["Invalide Environement variable mapping"];case"port":return xa.exec(t)?(e.state.inputDialogKey,null):["Invalide port mapping"];case"dns":return _a.exec(t)?(e.state.inputDialogKey,null):["Invalide DNS"]}}),s.a.createElement(me,{show:this.state.loading,message:this.state.loadingMessage}))}}]),t}(s.a.Component),wa=Object(m.b)(function(e,t){return{userSession:e.userSession,containers:e.containers,networks:e.networks,dockerImages:e.dockerImages,nginxConfigs:e.nginxConfigs,nginxDockerLinks:e.nginxDockerLinks,solutionParameters:e.solutionParameters}},function(e){return{dispatch:e}})(Object(ne.withStyles)(Jt)(Na)),Aa=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).sharedView=null,a.handleSnackClose=function(e,t){"clickaway"!==t&&a.setState({snackOpen:!1})},a.state={snackOpen:!1,snackMessage:"",snackVariant:null},a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"openSnack",value:function(e,t){this.setState({snackOpen:!0,snackMessage:e,snackVariant:t||"success"})}},{key:"render",value:function(){var e=this;return this.props.userSession.token?s.a.createElement(ge,{ref:function(t){return e.sharedView=t},history:this.props.history,pageIndex:1,notify:this.openSnack.bind(this)},s.a.createElement(se.m,{item:!0,xs:12},s.a.createElement(se.m,{container:!0,spacing:16},s.a.createElement(se.m,{item:!0,xs:4},s.a.createElement(se.m,{container:!0,spacing:16},s.a.createElement(se.m,{item:!0,xs:12},s.a.createElement(ta,{notify:this.openSnack.bind(this)})))),s.a.createElement(se.m,{item:!0,xs:8},s.a.createElement(wa,{notify:this.openSnack.bind(this)})))),s.a.createElement(Ge,{open:this.state.snackOpen,handleClose:this.handleSnackClose,message:this.state.snackMessage,variant:this.state.snackVariant})):s.a.createElement(ee.a,{to:"/login"})}}]),t}(s.a.Component),Ia=Object(m.b)(function(e,t){return{userSession:e.userSession}},function(e){return{dispatch:e}})(Object(ne.withStyles)(re)(Aa)),Ta=a(138),Pa=a.n(Ta),ja=a(103),Ra=a.n(ja),La=a(104),Ba=a.n(La),Fa=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).handleClickButton=function(){var e=Object(i.a)(r.a.mark(function e(t){var n,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=16;break}return(n=new FormData).append("privkey",a.state.privkey),n.append("cert",a.state.cert),e.prev=4,e.next=7,H.endpoints.Domains.uploadCertificate(a.props.domainId,n);case 7:(i=e.sent).data.success?(a.props.notify("Certificate uploaded!"),a.props.onDone(),a.close()):a.props.notify(i.data.error,"error"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),a.props.notify(e.t0.message,"error");case 14:e.next=17;break;case 16:a.close();case 17:case"end":return e.stop()}},e,null,[[4,11]])}));return function(t){return e.apply(this,arguments)}}(),a.close=function(){!function(){var e=document.getElementById("react-ssl-cert-upload-dialog");Object(l.unmountComponentAtNode)(e),e.parentNode.removeChild(e)}()},a.keyboardClose=function(e){27===e.keyCode&&a.close()},a.componentDidMount=function(){document.addEventListener("keydown",a.keyboardClose,!1)},a.componentWillUnmount=function(){document.removeEventListener("keydown",a.keyboardClose,!1),a.props.willUnmount()},a.state={privkey:null,cert:null},a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"handleFileSelected",value:function(e,t){if(t.target.files&&1==t.target.files.length){var a=t.target.files[0].name;a.toLowerCase().endsWith(".pem")||a.toLowerCase().endsWith(".crt")?this.setState(Object(ut.a)({},e,t.target.files[0])):this.props.notify("Invalide file format","error")}}},{key:"openFileDialog",value:function(e){c.a.findDOMNode(this.refs[e]).click()}},{key:"render",value:function(){var e=this;return s.a.createElement(qe.a,{open:!0,onClose:this.close,"aria-labelledby":"ssl-cert-upload-dialog-title","aria-describedby":"ssl-cert-upload-dialog-description"},s.a.createElement(tt.a,{id:"ssl-cert-upload-dialog-title"},"Upload SSL certificate files"),s.a.createElement(Ze.a,null,s.a.createElement(Qe.a,{id:"ssl-cert-upload-dialog-description"},"Please upload the required certificate files for this domain. If you are using subdomains, make sure your certificate is a wild card certificate."),s.a.createElement(yt.a,{style:{marginTop:10,marginBottom:10}}),s.a.createElement(Qe.a,{id:"ssl-cert-upload-dialog-description"},"Some of the browsers may consider the connection as unsafe, if there is no valid intermediate certificate. So, proper installation of intermediate certificate is a critical step.",s.a.createElement("br",null),s.a.createElement("br",null),"Most of the times, the primary certificate and intermediate certificate will be given as 2 different files.",s.a.createElement("br",null),"For example, we combine the primary certificate and the intermediate certificate using the below command."),s.a.createElement("div",{style:{backgroundColor:"#eeeeee",padding:10,marginTop:20,marginBottom:20}},"cat domain.crt domain_intermediate.ca-bundle >> ssl_bundle.crt"),s.a.createElement(mt,{ref:function(t){return e.formEl=t}},s.a.createElement(pa.a,{container:!0,alignItems:"center",style:{marginTop:20}},s.a.createElement(pa.a,{item:!0,xs:3,style:{textAlign:"right"}},"Private Key"),s.a.createElement(pa.a,{item:!0,xs:3,style:{textAlign:"center"}},s.a.createElement("input",{style:{display:"none"},type:"file",ref:"ssl_privkey",onChange:this.handleFileSelected.bind(this,"privkey")}),s.a.createElement("label",{htmlFor:"raised-button-file"},s.a.createElement(He.a,{variant:"contained",color:this.state.privkey?"primary":"default",onClick:this.openFileDialog.bind(this,"ssl_privkey")},this.state.privkey?"SELECTED":"SELECT",s.a.createElement(bt.a,{style:{marginLeft:10}})))),s.a.createElement(pa.a,{item:!0,xs:3,style:{textAlign:"right"}},"Certificate"),s.a.createElement(pa.a,{item:!0,xs:3,style:{textAlign:"center"}},s.a.createElement("input",{style:{display:"none"},type:"file",ref:"ssl_cert",onChange:this.handleFileSelected.bind(this,"cert")}),s.a.createElement("label",{htmlFor:"raised-button-file"},s.a.createElement(He.a,{variant:"contained",color:this.state.cert?"primary":"default",onClick:this.openFileDialog.bind(this,"ssl_cert")},this.state.cert?"SELECTED":"SELECT",s.a.createElement(bt.a,{style:{marginLeft:10}}))))))),s.a.createElement(Ye.a,null,this.state.privkey&&this.state.cert&&s.a.createElement(He.a,{onClick:function(){return e.handleClickButton(!0)}},"Upload"),s.a.createElement(He.a,{onClick:function(){return e.handleClickButton()}},"Cancel")))}}]),t}(s.a.Component);function Va(e){!function(e){var t=document.getElementById("react-ssl-cert-upload-dialog");t?Object(l.render)(s.a.createElement(Fa,e),t):(document.body.children[0].classList.add("react-ssl-cert-upload-dialog-blur"),(t=document.createElement("div")).id="react-ssl-cert-upload-dialog",document.body.appendChild(t),Object(l.render)(s.a.createElement(Fa,e),t))}(e)}Fa.defaultProps={buttons:[{label:"Cancel",onClick:function(){return null}},{label:"Upload",onClick:function(){return null}}],willUnmount:function(){return null}};var Ma=/\b(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\b/;function Ua(e){return s.a.createElement(qt.a,Object.assign({direction:"up"},e))}var Wa=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).SET_DATA_REDUCER_ACTION="SET_DOMAINS",a.handleDialogClose=function(){a.setSelected(null,null)},a.saveDialogData=function(){Object(i.a)(r.a.mark(function e(){var t,n,i,o,s,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.formEl.validate()){e.next=41;break}if(!a.props.domains.find(function(e){return(!a.state._id||e.id!=a.state._id)&&e.value.toLowerCase()==a.state._value.toLowerCase()})){e.next=4;break}return e.abrupt("return",a.props.notify("Conflict: domain name already in use.","error"));case 4:if(!Ma.exec(a.state._value)||!a.props.nginxConfigs.find(function(e){return e.domainId&&e.domainId==a.state._id})){e.next=6;break}return e.abrupt("return",a.props.notify("Conflict: At least one nginx config uses subdomains associated with this domain.","error"));case 6:if(t=a.populateSelected(a.state),e.prev=7,n=!0,!t.httpsEnabled){e.next=14;break}return e.next=12,H.endpoints.Domains.remote("checkDomainSslCert?domainId="+a.state._id,null,"get");case 12:i=e.sent,n=i.data.configured;case 14:if(!n){e.next=33;break}if("ADD"!==a.state.mode){e.next=22;break}return e.next=18,H.endpoints.Domains.create(t);case 18:o=e.sent,a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:[].concat(Object(j.a)(a.props.domains),[o])}),e.next=28;break;case 22:return t.id=a.state._id,e.next=25,H.endpoints.Domains.update(t);case 25:s=e.sent,l=a.props.domains.map(function(e){return e.id===a.state._id?s:e}),a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:l});case 28:a.setState({sslMissing:!1}),a.setSelected(null,null),a.props.notify("Saved"),e.next=34;break;case 33:a.setState({sslMissing:!0});case 34:e.next=40;break;case 36:e.prev=36,e.t0=e.catch(7),console.log("ERROR =>",e.t0),a.props.notify("An error occured, make sure the server is running.","error");case 40:case 41:case"end":return e.stop()}},e,null,[[7,36]])}))()},a.deleteDialogData=Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.props.nginxConfigs.find(function(e){return e.domainId&&e.domainId==a.state._id})?a.props.notify("Conflict: Cannot delete because there is at least one nginx config that uses this domain.","error"):nt({title:null,message:"Are you sure you want to delete this?",buttons:[{label:"Yes",onClick:function(){var e=Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,H.endpoints.Domains.deleteById(a.state._id);case 3:a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:a.props.domains.filter(function(e){return e.id!=a.state._id})}),a.setSelected(null,null),a.props.notify("Deleted"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("ERROR =>",e.t0),a.props.notify("An error occured, make sure the server is running.","error");case 12:case"end":return e.stop()}},e,null,[[0,8]])}));return function(){return e.apply(this,arguments)}}()},{label:"No",onClick:function(){}}]});case 1:case"end":return e.stop()}},e)})),a.state=a.populateEditorFormFromObject(),a.state.selected=null,a.state.mode=null,a.state.sslMissing=!1,a.state.defaultDomain=null,a.tblClickDebouncer=null,a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=setInterval(function(){e.props.settings.length>0&&(e.setState({defaultDomain:e.props.settings.find(function(e){return"defaultNginxDomain"==e.name}).value}),clearInterval(t))},100)}},{key:"tableRow",value:function(e,t,a,n,r){var i=this;return s.a.createElement(Bt.a,{hover:!0,key:r.id,className:a?"":"hoverPointer",onClick:function(e){i.handleRowClick(e,r.id)},selected:n&&n===r.id},s.a.createElement(Pt.a,{className:e},r.value),s.a.createElement(Pt.a,{className:e,padding:"none"},r.httpsEnabled&&s.a.createElement(Pa.a,null)),s.a.createElement(Pt.a,{className:t},s.a.createElement(fa.a,{checked:this.state.defaultDomain==r.value,value:r.value,onChange:this.defaultDomainToggleEvent.bind(this)})))}},{key:"defaultDomainToggleEvent",value:function(e){var t=this;this.tblClickDebouncer&&clearTimeout(this.tblClickDebouncer);var a=this.state.defaultDomain,n=e.target&&e.target.checked,o=e.target&&e.target.value?e.target.value:"";Object(i.a)(r.a.mark(function e(){var i,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState({defaultDomain:n?o:null}),i=t.props.settings.find(function(e){return"defaultNginxDomain"==e.name}),e.prev=2,i.value=n?o:"",e.next=6,H.endpoints.Settings.update(i);case 6:s=(s=JSON.parse(JSON.stringify(t.props.settings))).map(function(e){return"defaultNginxDomain"==e.name&&(e.value=n?o:""),e}),t.props.dispatch({type:"SET_SETTINGS",data:s}),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(2),i.value=a,t.setState({defaultDomain:a}),t.props.notify("Could not save default domain, make sure the server is running.","error");case 16:case"end":return e.stop()}},e,null,[[2,11]])}))()}},{key:"populateEditorFormFromObject",value:function(e){return{_id:e&&e.id?e.id:null,_value:e&&e.value?e.value:"",_httpsEnabled:!(!e||!e.httpsEnabled)&&e.httpsEnabled,sslMissing:!1}}},{key:"populateSelected",value:function(e){return{value:e._value,httpsEnabled:e._httpsEnabled}}},{key:"tableHeader",value:function(){return s.a.createElement(Bt.a,null,s.a.createElement(Pt.a,{className:this.props.classes.tableHeaderCell},"Domain"),s.a.createElement(Pt.a,{className:this.props.classes.tableHeaderCell,padding:"none"},"SSL"),s.a.createElement(Pt.a,{className:[this.props.classes.tableCellButton,this.props.classes.tableHeaderCell].join(" ")},"Is default"))}},{key:"getDialogFormBlockName",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:7,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"value",className:"form-control",value:this.state._value,onChange:function(t){e.setState({_value:t.target.value})},label:"Value (acme.com)",type:"text",fullWidth:!0,autoFocus:!0,required:!0}),s.a.createElement("div",{className:"invalid-feedback"})))}},{key:"getDialogFormBlockHttpsEnabled",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:5,style:{textAlign:"right"}},this.state._id&&s.a.createElement(ba.a,{style:{marginRight:0},control:s.a.createElement(fa.a,{checked:this.state._httpsEnabled,onChange:function(t){e.setState({_httpsEnabled:t.target.checked}),t.target.checked?(e.props.setLoading(!0),H.endpoints.Domains.remote("checkDomainSslCert?domainId="+e.state._id,null,"get").then(function(t){e.props.setLoading(!1),e.setState({sslMissing:!t.data.configured})}).catch(function(t){e.props.setLoading(!1),e.props.notify("A server problem occured.","error")})):e.setState({sslMissing:!1})}}),label:"HTTPS Enabled"}))}},{key:"getDialogFormBlockUploadCertificates",value:function(){var e=this;return this.state._httpsEnabled?s.a.createElement(se.m,{item:!0,xs:12,style:{textAlign:"right"}},s.a.createElement(Ht.a,{gutterBottom:!0,variant:"caption"},"If you already have a certificate, upload it now"),s.a.createElement(se.b,{color:"primary",variant:"outlined",onClick:function(t){Va({notify:e.props.notify,domainId:e.state._id,onDone:function(){var t=Object(i.a)(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({sslMissing:!1});case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()})}},"Upload certificates")):null}},{key:"setSelected",value:function(e,t){var a=this.populateEditorFormFromObject(t);a.selected=t,a.mode=e,this.setState(a)}},{key:"handleRowClick",value:function(e,t){var a=this.props.domains.find(function(e){return e.id===t});this.state.selected&&this.state._id===a.id||(this.setState({selected:null}),this.tblClickDebouncer&&clearTimeout(this.tblClickDebouncer),this.tblClickDebouncer=setTimeout(function(e){this.tblClickDebouncer=null,this.setSelected("EDIT",JSON.parse(JSON.stringify(e)))}.bind(this,a),200))}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.tableHeader();return s.a.createElement(se.y,{className:t.paper},s.a.createElement("div",{className:t.tableTitleDiv},"Domains"),s.a.createElement(se.h,{variant:"middle",style:{marginLeft:0,marginRight:0,marginTop:0,marginBottom:20}}),s.a.createElement(se.b,{variant:"contained",color:"primary",style:{textTransform:"none",position:"absolute",right:10,top:10},onClick:this.setSelected.bind(this,"ADD",{})},"New"),s.a.createElement(Ra.a,{className:t.cardInfo},s.a.createElement(Ba.a,null,s.a.createElement(Ht.a,null,'The default domain is used to expose the "private server hub" admin console through the NGinx reverse proxy, therefore making it accessible from outside your home.'))),s.a.createElement(wt.a,{className:t.table},a&&s.a.createElement(Rt.a,null,a),s.a.createElement(It.a,null,this.props.domains.map(function(a){var n=[t.tableCell];return n=n.join(" "),e.tableRow(n,t.tableCellButton,e.state.selected&&e.state.selected.id===a.id,e.state._id?e.state._id:null,a)}),0==this.props.domains.length&&s.a.createElement(Bt.a,null,s.a.createElement(Pt.a,{style:{textAlign:"center"},colSpan:3},s.a.createElement(Ht.a,{variant:"caption"},"-none-"))))),this.state.loading&&s.a.createElement(Vt.a,{color:"secondary"}),s.a.createElement(qe.a,{TransitionComponent:Ua,open:!!this.state.selected,onClose:this.handleDialogClose,scroll:"paper"},s.a.createElement(Ut.a,{className:t.appBar},s.a.createElement(Gt.a,null,s.a.createElement(Pe.a,{color:"inherit",onClick:this.handleDialogClose,"aria-label":"Close"},s.a.createElement(Oe.a,null)),s.a.createElement(Ht.a,{variant:"h6",color:"inherit",className:t.flex},"EDIT"===this.state.mode?"Edit":"Add"," domain"),s.a.createElement(se.b,{color:"inherit",onClick:this.saveDialogData},"Save"),"EDIT"===this.state.mode&&s.a.createElement(se.b,{color:"secondary",onClick:this.deleteDialogData},"Delete"))),s.a.createElement("div",{className:t.formDiv},this.state.selected&&s.a.createElement(mt,{ref:function(t){return e.formEl=t}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.m,{container:!0,spacing:16},this.getDialogFormBlockName(),this.getDialogFormBlockHttpsEnabled(),this.getDialogFormBlockUploadCertificates())))),s.a.createElement(Ze.a,null,this.state.sslMissing&&s.a.createElement("div",null,s.a.createElement("br",null),s.a.createElement(Ht.a,{gutterBottom:!0,variant:"h6"},"No certificate found for this domain!"),s.a.createElement(Ht.a,{variant:"subtitle2",gutterBottom:!0},"Instructions to generate the missing certificates:"),s.a.createElement(Ra.a,{className:t.card},s.a.createElement(Ba.a,null,s.a.createElement(Ht.a,{variant:"subtitle2",gutterBottom:!0},"Get the certbot docker image for your domain registrar:"),s.a.createElement("br",null),s.a.createElement(Ht.a,{component:"p",style:{color:"#3d499c"}},"docker pull certbot/certbot",s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("span",{style:{color:"#555555"}},"or"),s.a.createElement("br",null),s.a.createElement("br",null),"docker pull certbot/dns-dnsmadeeasy",s.a.createElement("br",null),"docker pull certbot/dns-dnsimple",s.a.createElement("br",null),"docker pull certbot/dns-ovh",s.a.createElement("br",null),"docker pull certbot/dns-cloudflare",s.a.createElement("br",null),"docker pull certbot/dns-cloudxns",s.a.createElement("br",null),"docker pull certbot/dns-digitalocean",s.a.createElement("br",null),"docker pull certbot/dns-google",s.a.createElement("br",null),"docker pull certbot/dns-luadns",s.a.createElement("br",null),"docker pull certbot/dns-nsone",s.a.createElement("br",null),"docker pull certbot/dns-rfc2136",s.a.createElement("br",null),"docker pull certbot/dns-route53",s.a.createElement("br",null),"docker pull certbot/dns-gehirn",s.a.createElement("br",null),"docker pull certbot/dns-linode",s.a.createElement("br",null),"docker pull certbot/dns-sakuracloud"),s.a.createElement("br",null),s.a.createElement(Ht.a,{variant:"subtitle2",gutterBottom:!0},"Generate your SSL certificate:"),s.a.createElement("br",null),s.a.createElement(Ht.a,{component:"p"},'The following command will create your certificate using the certbot docker image. This command assumes that you are creating the certificate manually without the use of a plugin (using the docker image "certbot/certbot"). If you are using a specific dns plugin, modify the bold section accordingly.'),s.a.createElement("br",null),s.a.createElement(Ht.a,{component:"p",style:{color:"#3d499c"}},'docker run -it --rm --name certbot -v "/usr/local/private-server-hub/.letsencrypt:/etc/letsencrypt" ',s.a.createElement("span",{style:{fontWeight:"bold"}},"certbot/certbot")," \\",s.a.createElement("br",null),s.a.createElement("span",{style:{fontWeight:"bold"}},'certonly --manual --preferred-challenges dns-01 --agree-tos -d "',this.state._value,'" -d "*.',this.state._value,'" --server https://acme-v02.api.letsencrypt.org/directory')),s.a.createElement("br",null),s.a.createElement(Ht.a,{component:"p"},"Follow the instructions provided when executed the above command."),s.a.createElement("br",null),s.a.createElement(Ht.a,{variant:"subtitle2",gutterBottom:!0},"Set up auto-renew of your certificate:"),s.a.createElement("br",null),s.a.createElement(Ht.a,{component:"p"},"Open your crontab:"),s.a.createElement(Ht.a,{component:"p",style:{color:"#3d499c"}},"crontab -e"),s.a.createElement("br",null),s.a.createElement(Ht.a,{component:"p"},"Add the following line to it:"),s.a.createElement(Ht.a,{component:"p",style:{color:"#3d499c"}},'0 5 * * * docker run -it --rm --name certbot -v "/usr/local/private-server-hub/.letsencrypt:/etc/letsencrypt" ',s.a.createElement("span",{style:{fontWeight:"bold"}},"certbot/certbot")," renew --quiet && docker container exec psh_nginx nginx -s reload > /dev/null 2>&1",s.a.createElement("br",null))))),this.state._httpsEnabled&&!this.state.sslMissing&&s.a.createElement(Ht.a,{gutterBottom:!0,variant:"body1",component:"h2"},"Certificate configured!"))))}}]),t}(s.a.Component),Ga=Object(m.b)(function(e,t){return{domains:e.domains,settings:e.settings,nginxConfigs:e.nginxConfigs}},function(e){return{dispatch:e}})(Object(ne.withStyles)(Jt)(Wa));function za(e){return s.a.createElement(qt.a,Object.assign({direction:"up"},e))}var Ha=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).SET_DATA_REDUCER_ACTION="SET_BASICAUTH",a.handleDialogClose=function(){a.setSelected(null,null)},a.saveDialogData=function(){Object(i.a)(r.a.mark(function e(){var t,n,i,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.formEl.validate()){e.next=28;break}if(!a.props.basicAuth.find(function(e){return(!a.state._id||e.id!=a.state._id)&&e.username.toLowerCase()==a.state._username.toLowerCase()})){e.next=4;break}return e.abrupt("return",a.props.notify("Conflict: Basic Auth username already in use.","error"));case 4:if(t=a.populateSelected(a.state),e.prev=5,"ADD"!==a.state.mode){e.next=13;break}return e.next=9,H.endpoints.BasicAuths.create(t);case 9:n=e.sent,a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:[].concat(Object(j.a)(a.props.basicAuth),[n])}),e.next=19;break;case 13:return t.id=a.state._id,e.next=16,H.endpoints.BasicAuths.update(t);case 16:i=e.sent,o=a.props.basicAuth.map(function(e){return e.id===a.state._id?i:e}),a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:o});case 19:a.setSelected(null,null),a.props.notify("Saved"),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(5),console.log("ERROR =>",e.t0),a.props.notify("An error occured, make sure the server is running.","error");case 27:case 28:case"end":return e.stop()}},e,null,[[5,23]])}))()},a.deleteDialogData=Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.props.nginxConfigs.find(function(e){return e.basicAuthId==a.state._id})){e.next=4;break}return e.abrupt("return",a.props.notify("Conflict: this auth user is used by at least one nginx configuration.","error"));case 4:nt({title:null,message:"Are you sure you want to delete this?",buttons:[{label:"Yes",onClick:function(){var e=Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,H.endpoints.BasicAuths.deleteById(a.state._id);case 3:a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:a.props.basicAuth.filter(function(e){return e.id!=a.state._id})}),a.setSelected(null,null),a.props.notify("Deleted"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("ERROR =>",e.t0),a.props.notify("An error occured, make sure the server is running.","error");case 12:case"end":return e.stop()}},e,null,[[0,8]])}));return function(){return e.apply(this,arguments)}}()},{label:"No",onClick:function(){}}]});case 5:case"end":return e.stop()}},e)})),a.state=a.populateEditorFormFromObject(),a.state.selected=null,a.state.mode=null,a.tblClickDebouncer=null,a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"tableRow",value:function(e,t,a,n){var r=this;return s.a.createElement(Bt.a,{hover:!0,key:n.id,className:t?"":"hoverPointer",onClick:function(e){return r.handleRowClick(e,n.id)},selected:a&&a===n.id},s.a.createElement(Pt.a,{className:e},n.username))}},{key:"populateEditorFormFromObject",value:function(e){return{_id:e&&e.id?e.id:null,_username:e&&e.username?e.username:"",_password:e&&e.password?e.password:""}}},{key:"populateSelected",value:function(e){return{username:e._username,password:e._password}}},{key:"tableHeader",value:function(){return s.a.createElement(Bt.a,null,s.a.createElement(Pt.a,{className:this.props.classes.tableHeaderCell},"Username"))}},{key:"generateFormContent",value:function(){var e=this;return s.a.createElement("div",{className:"form-group"},s.a.createElement(se.m,{container:!0,spacing:16},s.a.createElement(se.m,{item:!0,xs:12,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"username",className:"form-control",value:this.state._username,onChange:function(t){e.setState({_username:t.target.value})},label:"User name",type:"text",fullWidth:!0,autoFocus:!0,required:!0}),s.a.createElement("div",{className:"invalid-feedback"}))),s.a.createElement(se.m,{item:!0,xs:12,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"password",className:"form-control",value:this.state._password,onChange:function(t){e.setState({_password:t.target.value})},label:"Password",type:"password",fullWidth:!0,required:!0}),s.a.createElement("div",{className:"invalid-feedback"})))))}},{key:"setSelected",value:function(e,t){var a=this.populateEditorFormFromObject(t);a.selected=t,a.mode=e,this.setState(a)}},{key:"handleRowClick",value:function(e,t){var a=this.props.basicAuth.find(function(e){return e.id===t});this.state.selected&&this.state._id===a.id||(this.setState({selected:null}),this.tblClickDebouncer&&clearTimeout(this.tblClickDebouncer),this.tblClickDebouncer=setTimeout(function(e){this.tblClickDebouncer=null,this.setSelected("EDIT",JSON.parse(JSON.stringify(e)))}.bind(this,a),200))}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.tableHeader();return s.a.createElement(se.y,{className:t.paper},s.a.createElement("div",{className:t.tableTitleDiv},"Basic Auth Users"),s.a.createElement(se.h,{variant:"middle",style:{marginLeft:0,marginRight:0,marginTop:0,marginBottom:20}}),s.a.createElement(se.b,{variant:"contained",color:"primary",style:{textTransform:"none",position:"absolute",right:10,top:10},onClick:this.setSelected.bind(this,"ADD",{})},"New"),s.a.createElement(wt.a,{className:t.table},a&&s.a.createElement(Rt.a,null,a),s.a.createElement(It.a,null,this.props.basicAuth.map(function(a){var n=[t.tableCell];return n=n.join(" "),e.tableRow(n,e.state.selected&&e.state.selected.id===a.id,e.state._id?e.state._id:null,a)}),0==this.props.basicAuth.length&&s.a.createElement(Bt.a,null,s.a.createElement(Pt.a,{style:{textAlign:"center"}},s.a.createElement(Ht.a,{variant:"caption"},"-none-"))))),this.state.loading&&s.a.createElement(Vt.a,{color:"secondary"}),s.a.createElement(qe.a,{TransitionComponent:za,open:!!this.state.selected,onClose:this.handleDialogClose},s.a.createElement(Ut.a,{className:t.appBar},s.a.createElement(Gt.a,null,s.a.createElement(Pe.a,{color:"inherit",onClick:this.handleDialogClose,"aria-label":"Close"},s.a.createElement(Oe.a,null)),s.a.createElement(Ht.a,{variant:"h6",color:"inherit",className:t.flex},"EDIT"===this.state.mode?"Edit":"Add"," basic auth user"),s.a.createElement(se.b,{color:"inherit",onClick:this.saveDialogData},"Save"),"EDIT"===this.state.mode&&s.a.createElement(se.b,{color:"secondary",onClick:this.deleteDialogData},"Delete"))),s.a.createElement("div",{className:t.formDiv},this.state.selected&&s.a.createElement(mt,{ref:function(t){return e.formEl=t}},this.generateFormContent()))))}}]),t}(s.a.Component),Ka=Object(m.b)(function(e,t){return{basicAuth:e.basicAuth,nginxConfigs:e.nginxConfigs}},function(e){return{dispatch:e}})(Object(ne.withStyles)(Jt)(Ha));function qa(e){return s.a.createElement(qt.a,Object.assign({direction:"up"},e))}var Ja=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).SET_DATA_REDUCER_ACTION="SET_NGINX_PRESET_PARAMS",a.handleDialogClose=function(){a.setSelected(null,null)},a.saveDialogData=function(){Object(i.a)(r.a.mark(function e(){var t,n,i,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.formEl.validate()){e.next=28;break}if(!a.props.nginxPresetParams.find(function(e){return(!a.state._id||e.id!=a.state._id)&&e.name.toLowerCase()==a.state._name.toLowerCase()})){e.next=4;break}return e.abrupt("return",a.props.notify("Conflict: nginx preset params name already in use.","error"));case 4:if(t=a.populateSelected(a.state),e.prev=5,"ADD"!==a.state.mode){e.next=13;break}return e.next=9,H.endpoints.NginxPresetParams.create(t);case 9:n=e.sent,a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:[].concat(Object(j.a)(a.props.nginxPresetParams),[n])}),e.next=19;break;case 13:return t.id=a.state._id,e.next=16,H.endpoints.NginxPresetParams.update(t);case 16:i=e.sent,o=a.props.nginxPresetParams.map(function(e){return e.id===a.state._id?i:e}),a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:o});case 19:a.setSelected(null,null),a.props.notify("Saved"),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(5),console.log("ERROR =>",e.t0),a.props.notify("An error occured, make sure the server is running.","error");case 27:case 28:case"end":return e.stop()}},e,null,[[5,23]])}))()},a.deleteDialogData=Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.props.nginxConfigs.find(function(e){return e.nginxPresetParamsId&&e.nginxPresetParamsId==a.state._id})?a.props.notify("Conflict: Cannot delete because there is at least one nginx config that uses this preset params.","error"):nt({title:null,message:"Are you sure you want to delete this?",buttons:[{label:"Yes",onClick:function(){var e=Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,H.endpoints.NginxPresetParams.deleteById(a.state._id);case 3:a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:a.props.nginxPresetParams.filter(function(e){return e.id!=a.state._id})}),a.setSelected(null,null),a.props.notify("Deleted"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("ERROR =>",e.t0),a.props.notify("An error occured, make sure the server is running.","error");case 12:case"end":return e.stop()}},e,null,[[0,8]])}));return function(){return e.apply(this,arguments)}}()},{label:"No",onClick:function(){}}]});case 1:case"end":return e.stop()}},e)})),a.state=a.populateEditorFormFromObject(),a.state.selected=null,a.state.mode=null,a.state.inputDialogOpen=!1,a.state.inputDialogLabel="",a.state.inputDialogTarget="",a.state.inputDialogValue="",a.state.inputDialogKey="",a.state.inputDialogValueErrors=null,a.tblClickDebouncer=null,a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"tableRow",value:function(e,t,a,n){var r=this;return s.a.createElement(Bt.a,{hover:!0,key:n.id,className:t?"":"hoverPointer",onClick:function(e){return r.handleRowClick(e,n.id)},selected:a&&a===n.id},s.a.createElement(Pt.a,{className:e},n.name))}},{key:"populateEditorFormFromObject",value:function(e){return{_id:e&&e.id?e.id:null,_name:e&&e.name?e.name:"",_list:e&&e.list?e.list:[]}}},{key:"populateSelected",value:function(e){return{name:e._name,list:e._list}}},{key:"tableHeader",value:function(){return null}},{key:"setSelected",value:function(e,t){var a=this.populateEditorFormFromObject(t);a.selected=t,a.mode=e,this.setState(a)}},{key:"handleRowClick",value:function(e,t){var a=this.props.nginxPresetParams.find(function(e){return e.id===t});this.state.selected&&this.state._id===a.id||(this.setState({selected:null}),this.tblClickDebouncer&&clearTimeout(this.tblClickDebouncer),this.tblClickDebouncer=setTimeout(function(e){this.tblClickDebouncer=null,this.setSelected("EDIT",JSON.parse(JSON.stringify(e)))}.bind(this,a),200))}},{key:"stringEditorDialog",value:function(e,t,a){var n=this;return s.a.createElement(se.d,{open:this.state.inputDialogOpen,onClose:t.bind(this,"CANCEL"),"aria-labelledby":"form-dialog-title"},s.a.createElement(se.f,null,e&&s.a.createElement(se.g,null,e),s.a.createElement(se.C,{autoFocus:!0,margin:"dense",label:this.state.inputDialogLabel,type:"text",value:this.state.inputDialogValue,onChange:function(e){n.setState({inputDialogValue:e.target.value})},style:{width:500}}),this.state.inputDialogValueErrors&&this.state.inputDialogValueErrors.map(function(e,t){return s.a.createElement("div",{key:"err_"+t,style:{color:"red",fontSize:12}},e)})),s.a.createElement(se.e,null,s.a.createElement(se.b,{onClick:t.bind(this,"CANCEL"),color:"primary"},"Cancel"),s.a.createElement(se.b,{onClick:function(){if(a){var e=a(n.state.inputDialogValue);e?n.setState({inputDialogValueErrors:e}):t("SAVE")}else t("SAVE")},color:"primary"},"Save")))}},{key:"getDialogFormBlockName",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:12,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"name",className:"form-control",value:this.state._name,onChange:function(t){e.setState({_name:t.target.value})},label:"Identifier name",type:"text",fullWidth:!0,autoFocus:!0,required:!0}),s.a.createElement("div",{className:"invalid-feedback"})))}},{key:"getDialogFormBlockParamssList",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:12,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group",style:{textAlign:"left"}},s.a.createElement(se.m,{container:!0},s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"left"}},s.a.createElement(se.u,{component:"div"},"Nginx block params")),s.a.createElement(se.m,{item:!0,xs:6,style:{textAlign:"right"}},s.a.createElement(se.b,{color:"primary",style:{marginTop:8},onClick:function(t){e.setState({inputDialogOpen:!0,inputDialogValue:"",inputDialogValueErrors:null,inputDialogTarget:"list",inputDialogLabel:"Nginx block params",inputDialogKey:null})}},"Add param line"))),s.a.createElement(se.p,{dense:!1},this.state._list.map(function(t,a){return s.a.createElement(se.q,{key:"blockparam_"+a,button:!0,onClick:function(e,t){this.setState({inputDialogOpen:!0,inputDialogValue:e,inputDialogValueErrors:null,inputDialogTarget:"list",inputDialogLabel:"Nginx block params",inputDialogKey:t})}.bind(e,t,a)},s.a.createElement(na.a,null),s.a.createElement(se.t,{primary:t,secondary:null}),s.a.createElement(se.s,{onClick:function(e){this.state._list.splice(e,1),this.setState({_list:this.state._list})}.bind(e,a)},s.a.createElement(se.n,{"aria-label":"Delete"},s.a.createElement(ht.a,null))))}),0==this.state._list.length&&s.a.createElement(Ht.a,{variant:"caption",className:this.props.classes.emptyDialogLine},"-none-"))))}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.tableHeader();return s.a.createElement(se.y,{className:t.paper},s.a.createElement("div",{className:t.tableTitleDiv},"Config preset parameters"),s.a.createElement(se.h,{variant:"middle",style:{marginLeft:0,marginRight:0,marginTop:0,marginBottom:20}}),s.a.createElement(se.b,{variant:"contained",color:"primary",style:{textTransform:"none",position:"absolute",right:10,top:10},onClick:this.setSelected.bind(this,"ADD",{})},"New"),s.a.createElement(wt.a,{className:t.table},a&&s.a.createElement(Rt.a,null,a),s.a.createElement(It.a,null,this.props.nginxPresetParams.map(function(a){var n=[t.tableCell];return n=n.join(" "),e.tableRow(n,e.state.selected&&e.state.selected.id===a.id,e.state._id?e.state._id:null,a)}),0==this.props.nginxPresetParams.length&&s.a.createElement(Bt.a,null,s.a.createElement(Pt.a,{style:{textAlign:"center"}},s.a.createElement(Ht.a,{variant:"caption"},"-none-"))))),this.state.loading&&s.a.createElement(Vt.a,{color:"secondary"}),s.a.createElement(se.d,{TransitionComponent:qa,open:!!this.state.selected,onClose:this.handleDialogClose},s.a.createElement(Ut.a,{className:t.appBar},s.a.createElement(Gt.a,null,s.a.createElement(se.n,{color:"inherit",onClick:this.handleDialogClose,"aria-label":"Close"},s.a.createElement(Oe.a,null)),s.a.createElement(Ht.a,{variant:"h6",color:"inherit",className:t.flex},"EDIT"===this.state.mode?"Edit":"Add"," params"),s.a.createElement(se.b,{color:"inherit",onClick:this.saveDialogData},"Save"),"EDIT"===this.state.mode&&s.a.createElement(se.b,{color:"secondary",onClick:this.deleteDialogData},"Delete"))),s.a.createElement("div",{className:t.formDiv},this.state.selected&&s.a.createElement(mt,{ref:function(t){return e.formEl=t}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.m,{container:!0,spacing:16},this.getDialogFormBlockName(),this.getDialogFormBlockParamssList()))))),this.stringEditorDialog(null,function(t){switch(t+"_"+e.state.inputDialogTarget){case"SAVE_list":null!=e.state.inputDialogKey?(e.state._list[e.state.inputDialogKey]=e.state.inputDialogValue,e.setState({_list:e.state._list})):(e.state._list.push(e.state.inputDialogValue),e.setState({_list:e.state._list}))}e.setState({inputDialogOpen:!1})},function(t){switch(e.state.inputDialogTarget){case"list":return 0==t.length?["Required"]:null}}))}}]),t}(s.a.Component),Ya=Object(m.b)(function(e,t){return{nginxPresetParams:e.nginxPresetParams,nginxConfigs:e.nginxConfigs}},function(e){return{dispatch:e}})(Object(ne.withStyles)(Jt)(Ja)),Xa=/([^A-Za-z0-9_]+)/,Za=/\b(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\b/,$a={PaperProps:{style:{maxHeight:224,width:250}}};function Qa(e){return s.a.createElement(qt.a,Object.assign({direction:"up"},e))}var en=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).SET_DATA_REDUCER_ACTION="SET_NGINX_CONFIGS",a.handleDialogClose=function(){a.setSelected(null,null)},a.saveDialogData=function(){Object(i.a)(r.a.mark(function e(){var t,n,i,o,s,l,c,u,d,m,p;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.formEl.validate()){e.next=69;break}if(!Xa.exec(a.state._name)){e.next=4;break}return e.abrupt("return",a.props.notify("Error: nginx name must contain only letters, numbers or underscore.","error"));case 4:if(!a.props.nginxConfigs.find(function(e){return(!a.state._id||e.id!=a.state._id)&&e.name.toLowerCase()==a.state._name.toLowerCase()})){e.next=6;break}return e.abrupt("return",a.props.notify("Conflict: nginx config name already in use.","error"));case 6:if("h"!=a.state._serverTarget||"16199"!=a.state._port&&"80"!=a.state._port&&"443"!=a.state._port&&"9443"!=a.state._port){e.next=8;break}return e.abrupt("return",a.props.notify("Conflict: Host ports 16199, 80 & 443 are reserved ports.","error"));case 8:if(!a.state._asSubdomain||a.state._domainId&&0!=a.state._domainId.length){e.next=10;break}return e.abrupt("return",a.props.notify("Error: You need to specify a domain since you configured a subdomain.","error"));case 10:if(!a.state._asSubdomain||!Za.exec(a.props.domains.find(function(e){return e.id==a.state._domainId}).value)){e.next=12;break}return e.abrupt("return",a.props.notify("Error: subdomains are only allowed with real domain names.","error"));case 12:if(t=a.populateSelected(a.state),e.prev=13,"ADD"!==a.state.mode){e.next=31;break}return e.next=17,H.endpoints.NginxConfigs.create(t);case 17:if(n=e.sent,!(a.state._selectedContainers.length>0)){e.next=28;break}i=0;case 20:if(!(i<a.state._selectedContainers.length)){e.next=28;break}return e.next=23,H.endpoints.NginxDockerLinks.create({containerId:a.state._selectedContainers[i],nginxConfigId:n.id});case 23:o=e.sent,a.props.dispatch({type:"ADD_NGINX_DOCKER_LINKS",data:[o]});case 25:i++,e.next=20;break;case 28:a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:[].concat(Object(j.a)(a.props.nginxConfigs),[n])}),e.next=60;break;case 31:return t.id=a.state._id,e.next=34,H.endpoints.NginxConfigs.update(t);case 34:return s=e.sent,l=a.props.nginxConfigs.map(function(e){return e.id===a.state._id?s:e}),e.next=38,H.endpoints.NginxDockerLinks.getAll({where:{nginxConfigId:a.state._id}});case 38:c=e.sent,u=0;case 40:if(!(u<c.length)){e.next=48;break}if(-1!=a.state._selectedContainers.indexOf(c[u].containerId)){e.next=45;break}return e.next=44,H.endpoints.NginxDockerLinks.deleteById(c[u].id);case 44:a.props.dispatch({type:"DELETE_NGINX_DOCKER_LINK",data:c[u].id});case 45:u++,e.next=40;break;case 48:d=r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=c.find(function(e){return e.containerId==a.state._selectedContainers[t]})){e.next=5;break}return e.next=3,H.endpoints.NginxDockerLinks.create({containerId:a.state._selectedContainers[t],nginxConfigId:a.state._id});case 3:n=e.sent,a.props.dispatch({type:"ADD_NGINX_DOCKER_LINKS",data:[n]});case 5:case"end":return e.stop()}},e)}),m=0;case 50:if(!(m<a.state._selectedContainers.length)){e.next=55;break}return e.delegateYield(d(m),"t0",52);case 52:m++,e.next=50;break;case 55:return e.next=57,H.endpoints.Containers.getAll();case 57:p=e.sent,a.props.dispatch({type:"SET_CONTAINERS",data:p}),a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:l});case 60:a.setSelected(null,null),a.props.notify("Saved"),e.next=68;break;case 64:e.prev=64,e.t1=e.catch(13),console.log("ERROR =>",e.t1),a.props.notify("An error occured, make sure the server is running.","error");case 68:case 69:case"end":return e.stop()}},e,null,[[13,64]])}))()},a.deleteDialogData=Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:nt({title:null,message:"Are you sure you want to delete this?",buttons:[{label:"Yes",onClick:function(){var e=Object(i.a)(r.a.mark(function e(){var t,n,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=!1,n=0;case 3:if(!(n<a.props.nginxDockerLinks.length)){e.next=11;break}if(a.props.nginxDockerLinks[n].nginxConfigId!=a.state._id){e.next=8;break}return e.next=7,H.endpoints.NginxDockerLinks.deleteById(a.props.nginxDockerLinks[n].id);case 7:t=!0;case 8:n++,e.next=3;break;case 11:if(!t){e.next=16;break}return e.next=14,H.endpoints.NginxDockerLinks.getAll();case 14:i=e.sent,a.props.dispatch({type:"SET_NGINX_DOCKER_LINKS",data:i});case 16:return e.next=18,H.endpoints.NginxConfigs.deleteById(a.state._id);case 18:a.props.dispatch({type:a.SET_DATA_REDUCER_ACTION,data:a.props.nginxConfigs.filter(function(e){return e.id!=a.state._id})}),a.setSelected(null,null),a.props.notify("Deleted"),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(0),console.log("ERROR =>",e.t0),a.props.notify("An error occured, make sure the server is running.","error");case 27:case"end":return e.stop()}},e,null,[[0,23]])}));return function(){return e.apply(this,arguments)}}()},{label:"No",onClick:function(){}}]});case 1:case"end":return e.stop()}},e)})),a.state=a.populateEditorFormObject(),a.state.selected=null,a.state.mode=null,a.state.inputDialogOpen=!1,a.state.inputDialogLabel="",a.state.inputDialogTarget="",a.state.inputDialogValue="",a.state.inputDialogKey="",a.state.inputDialogValueErrors=null,a.tblClickDebouncer=null,a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"tableRow",value:function(e,t,a,n){var r=this,i=this.props.domains.find(function(e){return e.id==n.domainId});return s.a.createElement(Bt.a,{hover:!0,key:n.id,className:t?"":"hoverPointer",onClick:function(e){return r.handleRowClick(e,n.id)},selected:a&&a===n.id},s.a.createElement(Pt.a,{className:e},n.name),s.a.createElement(Pt.a,{className:[e,this.props.classes.tableCellButton].join(" ")},i?"".concat(i.httpsEnabled?"https":"http","://").concat(n.asSubdomain?n.subdomain+".":"").concat(i.value).concat(n.uriPath.length>0?(-1==n.uriPath.indexOf("/")?"/":"")+n.uriPath:""):""))}},{key:"populateEditorFormObject",value:function(e){return{_id:e&&e.id?e.id:null,_name:e&&e.name?e.name:"",_uriPath:e&&e.uriPath?e.uriPath:"",_port:e&&e.port?e.port:"",_asSubdomain:!(!e||!e.asSubdomain),_subdomain:e&&e.subdomain?e.subdomain:"",_proxyPath:e&&e.proxyPath?e.proxyPath:"",_nginxPresetParamsId:e&&e.nginxPresetParamsId?e.nginxPresetParamsId:"",_domainId:e&&e.domainId?e.domainId:"",_basicAuthId:e&&e.basicAuthId?e.basicAuthId:"",_serverTarget:e&&e.serverTarget?e.serverTarget:"c",_selectedContainers:e&&e.id?this.props.nginxDockerLinks.filter(function(t){return t.nginxConfigId==e.id}).map(function(e){return e.containerId}):[]}}},{key:"populateSelected",value:function(e){return{name:e._name,uriPath:e._uriPath,port:e._port,asSubdomain:e._asSubdomain,subdomain:e._subdomain,proxyPath:e._proxyPath,serverTarget:e._serverTarget,nginxPresetParamsId:e._nginxPresetParamsId?e._nginxPresetParamsId:null,domainId:e._domainId?e._domainId:null,basicAuthId:e._basicAuthId?e._basicAuthId:null}}},{key:"tableHeader",value:function(){return s.a.createElement(Bt.a,null,s.a.createElement(Pt.a,{className:this.props.classes.tableHeaderCell},"Name"),s.a.createElement(Pt.a,{className:[this.props.classes.tableCellButton,this.props.classes.tableHeaderCell].join(" ")},"URL"))}},{key:"setSelected",value:function(e,t){var a=this.populateEditorFormObject(t);a.selected=t,a.mode=e,this.setState(a)}},{key:"handleRowClick",value:function(e,t){var a=this.props.nginxConfigs.find(function(e){return e.id===t});this.state.selected&&this.state._id===a.id||(this.setState({selected:null}),this.tblClickDebouncer&&clearTimeout(this.tblClickDebouncer),this.tblClickDebouncer=setTimeout(function(e){this.tblClickDebouncer=null,this.setSelected("EDIT",JSON.parse(JSON.stringify(e)))}.bind(this,a),200))}},{key:"stringEditorDialog",value:function(e,t,a){var n=this;return s.a.createElement(se.d,{open:this.state.inputDialogOpen,onClose:t.bind(this,"CANCEL"),"aria-labelledby":"form-dialog-title"},s.a.createElement(se.f,null,e&&s.a.createElement(se.g,null,e),s.a.createElement(se.C,{autoFocus:!0,margin:"dense",label:this.state.inputDialogLabel,type:"text",value:this.state.inputDialogValue,onChange:function(e){n.setState({inputDialogValue:e.target.value})},style:{width:500}}),this.state.inputDialogValueErrors&&this.state.inputDialogValueErrors.map(function(e,t){return s.a.createElement("div",{key:"err_"+t,style:{color:"red",fontSize:12}},e)})),s.a.createElement(se.e,null,s.a.createElement(se.b,{onClick:t.bind(this,"CANCEL"),color:"primary"},"Cancel"),s.a.createElement(se.b,{onClick:function(){if(a){var e=a(n.state.inputDialogValue);e?n.setState({inputDialogValueErrors:e}):t("SAVE")}else t("SAVE")},color:"primary"},"Save")))}},{key:"getDialogFormBlockUriPath",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:8,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"_uriPath",className:"form-control",value:this.state._uriPath,onChange:function(t){e.setState({_uriPath:t.target.value})},label:"URI path",type:"text"}),s.a.createElement("div",{className:"invalid-feedback"})))}},{key:"getDialogFormBlockName",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:4,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"_name",className:"form-control",value:this.state._name,onChange:function(t){e.setState({_name:t.target.value})},label:"Config name",type:"text",fullWidth:!0,required:!0}),s.a.createElement("div",{className:"invalid-feedback"})))}},{key:"getDialogFormBlockPort",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:4,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{name:"_port",className:"form-control",value:this.state._port,onChange:function(t){e.setState({_port:t.target.value})},label:"c"==this.state._serverTarget?"Container port":"Host port",type:"text",fullWidth:!0,autoFocus:!0,required:!0}),s.a.createElement("div",{className:"invalid-feedback"})))}},{key:"getDialogFormBlockIsSubdomain",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:4,style:{textAlign:"left"}},s.a.createElement(Ea.a,{row:!0},s.a.createElement(ba.a,{control:s.a.createElement(fa.a,{checked:this.state._asSubdomain,onChange:function(t){e.setState({_asSubdomain:t.target.checked,_subdomain:""})}}),label:"Subdomain"})))}},{key:"getDialogFormBlockSubdomain",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:4,style:{textAlign:"left"}},this.state._asSubdomain&&s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{required:!0,name:"_subdomain",className:"form-control",value:this.state._subdomain,onChange:function(t){e.setState({_subdomain:t.target.value})},label:"Subdomain",type:"text",fullWidth:!0}),s.a.createElement("div",{className:"invalid-feedback"})))}},{key:"getDialogFormBlockPresetParams",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:8,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group",style:{textAlign:"left"}},s.a.createElement(se.j,{fullWidth:!0},s.a.createElement(se.o,{htmlFor:"_nginxPresetParamsId"},"NGinx preset configuration"),s.a.createElement(se.z,{value:this.state._nginxPresetParamsId,onChange:function(t){e.setState(Object(ut.a)({},t.target.name,t.target.value))},inputProps:{name:"_nginxPresetParamsId",id:"_nginxPresetParamsId"},fullWidth:!0},s.a.createElement(se.w,{value:""},s.a.createElement("em",null,"None")),this.props.nginxPresetParams.map(function(e){return s.a.createElement(se.w,{key:"ngparam_"+e.id,value:e.id},e.name)})))))}},{key:"getDialogFormBlockDomain",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:4,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group",style:{textAlign:"left"}},s.a.createElement(se.j,{fullWidth:!0},s.a.createElement(se.o,{htmlFor:"_domainId"},"Domain"),s.a.createElement(se.z,{value:this.state._domainId,onChange:function(t){e.setState(Object(ut.a)({},t.target.name,t.target.value))},inputProps:{name:"_domainId",id:"_domainId"},fullWidth:!0},s.a.createElement(se.w,{value:""},s.a.createElement("em",null,"None")),this.props.domains.map(function(e){return s.a.createElement(se.w,{key:"domain_"+e.id,value:e.id},e.value)})),s.a.createElement("div",{className:"invalid-feedback"}))))}},{key:"getDialogFormBlockBasicAuth",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:4,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group",style:{textAlign:"left"}},s.a.createElement(se.j,{fullWidth:!0},s.a.createElement(se.o,{htmlFor:"_basicAuthId"},"Basic Auth User"),s.a.createElement(se.z,{value:this.state._basicAuthId,onChange:function(t){e.setState(Object(ut.a)({},t.target.name,t.target.value))},inputProps:{name:"_basicAuthId",id:"_basicAuthId"},fullWidth:!0},s.a.createElement(se.w,{value:""},s.a.createElement("em",null,"None")),this.props.basicAuth.map(function(e){return s.a.createElement(se.w,{key:"basicAuth_"+e.id,value:e.id},e.username)})),s.a.createElement("div",{className:"invalid-feedback"}))))}},{key:"getDialogFormBlockServerTarget",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:4,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group",style:{textAlign:"left"}},s.a.createElement(se.j,{fullWidth:!0},s.a.createElement(se.o,{htmlFor:"_serverTarget"},"Target server type"),s.a.createElement(se.z,{required:!0,value:this.state._serverTarget,onChange:function(t){var a=Object(ut.a)({},t.target.name,t.target.value);"c"!=t.target.value&&(a._selectedContainers=[]),"e"!=t.target.value&&(a._port=""),e.setState(a)},inputProps:{name:"_serverTarget",id:"_serverTarget"},fullWidth:!0},s.a.createElement(se.w,{key:"serverTarget_c",value:"c"},"Container"),s.a.createElement(se.w,{key:"serverTarget_h",value:"h"},"Host"),s.a.createElement(se.w,{key:"serverTarget_e",value:"e"},"External")),s.a.createElement("div",{className:"invalid-feedback"}))))}},{key:"getDialogFormBlockContainers",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:4,style:{textAlign:"left"}},"c"==this.state._serverTarget&&s.a.createElement("div",{className:"form-group",style:{textAlign:"left"}},s.a.createElement(se.j,{fullWidth:!0},s.a.createElement(se.o,{htmlFor:"_selectedContainers"},"Containers"),s.a.createElement(se.z,{required:!0,multiple:!0,value:this.state._selectedContainers,onChange:function(t){e.setState({_selectedContainers:t.target.value})},renderValue:function(t){return e.props.containers.filter(function(e){return t.indexOf(e.id)>-1}).map(function(e){return e.name}).join(", ")},inputProps:{name:"_selectedContainers",id:"_selectedContainers"},MenuProps:$a,fullWidth:!0},this.props.containers.map(function(t){return s.a.createElement(se.w,{key:t.name,value:t.id},s.a.createElement(se.c,{checked:e.props.containers.filter(function(t){return e.state._selectedContainers.indexOf(t.id)>-1}).map(function(e){return e.name}).indexOf(t.name)>-1}),s.a.createElement(se.t,{primary:t.name}))})),s.a.createElement("div",{className:"invalid-feedback"}))),"e"==this.state._serverTarget&&s.a.createElement("div",{className:"form-group",style:{textAlign:"left"}},s.a.createElement(se.C,{required:!0,name:"_proxyPath",className:"form-control",value:this.state._proxyPath,onChange:function(t){e.setState({_proxyPath:t.target.value})},label:"Proxy path",type:"text",fullWidth:!0}),s.a.createElement("div",{className:"invalid-feedback"})))}},{key:"getDialogFormBlockProxyTarget",value:function(){var e=this;return s.a.createElement(se.m,{item:!0,xs:8,style:{textAlign:"left"}},s.a.createElement("div",{className:"form-group",style:{textAlign:"left"}},s.a.createElement(se.C,{required:!0,name:"_proxyPath",className:"form-control",value:this.state._proxyPath,onChange:function(t){e.setState({_proxyPath:t.target.value})},label:"Proxy path",type:"text",fullWidth:!0}),s.a.createElement("div",{className:"invalid-feedback"})))}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.tableHeader();return s.a.createElement(se.y,{className:t.paper},s.a.createElement("div",{className:t.tableTitleDiv},"Nginx configuration"),s.a.createElement(se.h,{variant:"middle",style:{marginLeft:0,marginRight:0,marginTop:0,marginBottom:20}}),s.a.createElement(se.b,{variant:"contained",color:"primary",style:{textTransform:"none",position:"absolute",right:10,top:10},onClick:this.setSelected.bind(this,"ADD",{})},"New"),s.a.createElement(wt.a,{className:t.table},a&&s.a.createElement(Rt.a,null,a),s.a.createElement(It.a,null,this.props.nginxConfigs.map(function(a){var n=[t.tableCell];return n=n.join(" "),e.tableRow(n,e.state.selected&&e.state.selected.id===a.id,e.state._id?e.state._id:null,a)}),0==this.props.nginxConfigs.length&&s.a.createElement(Bt.a,null,s.a.createElement(Pt.a,{style:{textAlign:"center"},colSpan:2},s.a.createElement(Ht.a,{variant:"caption"},"-none-"))))),this.state.loading&&s.a.createElement(Vt.a,{color:"secondary"}),s.a.createElement(se.d,{TransitionComponent:Qa,open:!!this.state.selected,onClose:this.handleDialogClose},s.a.createElement(Ut.a,{className:t.appBar},s.a.createElement(Gt.a,null,s.a.createElement(se.n,{color:"inherit",onClick:this.handleDialogClose,"aria-label":"Close"},s.a.createElement(Oe.a,null)),s.a.createElement(Ht.a,{variant:"h6",color:"inherit",className:t.flex},"EDIT"===this.state.mode?"Edit":"Add"," Nginx configuration"),s.a.createElement(se.b,{color:"inherit",onClick:this.saveDialogData},"Save"),"EDIT"===this.state.mode&&s.a.createElement(se.b,{color:"secondary",onClick:this.deleteDialogData},"Delete"))),s.a.createElement("div",{className:t.formDiv},this.state.selected&&s.a.createElement(mt,{ref:function(t){return e.formEl=t}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.m,{container:!0,spacing:16},this.getDialogFormBlockName(),this.getDialogFormBlockUriPath(),this.getDialogFormBlockIsSubdomain(),this.getDialogFormBlockSubdomain(),this.getDialogFormBlockDomain(),this.getDialogFormBlockBasicAuth(),this.getDialogFormBlockServerTarget(),"c"==this.state._serverTarget&&this.getDialogFormBlockContainers(),"e"!=this.state._serverTarget&&this.getDialogFormBlockPort(),"e"==this.state._serverTarget&&this.getDialogFormBlockProxyTarget(),this.getDialogFormBlockPresetParams()))))))}}]),t}(s.a.Component),tn=Object(m.b)(function(e,t){return{nginxConfigs:e.nginxConfigs,containers:e.containers,domains:e.domains,basicAuth:e.basicAuth,nginxPresetParams:e.nginxPresetParams,nginxDockerLinks:e.nginxDockerLinks}},function(e){return{dispatch:e}})(Object(ne.withStyles)(Jt)(en)),an=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).sharedView=null,a.handleSnackClose=function(e,t){"clickaway"!==t&&a.setState({snackOpen:!1})},a.state={loading:!1,loadingMessage:null,snackOpen:!1,snackMessage:"",snackVariant:null},a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"openSnack",value:function(e,t){this.setState({snackOpen:!0,snackMessage:e,snackVariant:t||"success"})}},{key:"loadingStateChange",value:function(e,t){this.setState({loading:e,loadingMessage:t})}},{key:"render",value:function(){var e=this;return this.props.userSession.token?s.a.createElement(ge,{ref:function(t){return e.sharedView=t},history:this.props.history,pageIndex:2,notify:this.openSnack.bind(this)},s.a.createElement(se.m,{item:!0,xs:12},s.a.createElement(se.m,{container:!0,spacing:16},s.a.createElement(se.m,{item:!0,xs:4},s.a.createElement(se.m,{container:!0,spacing:16},s.a.createElement(se.m,{item:!0,xs:12},s.a.createElement(Ga,{notify:this.openSnack.bind(this),setLoading:this.loadingStateChange.bind(this)})),s.a.createElement(se.m,{item:!0,xs:12},s.a.createElement(Ya,{notify:this.openSnack.bind(this)})),s.a.createElement(se.m,{item:!0,xs:12},s.a.createElement(Ka,{notify:this.openSnack.bind(this)})))),s.a.createElement(se.m,{item:!0,xs:8},s.a.createElement(tn,{notify:this.openSnack.bind(this)})))),s.a.createElement(me,{show:this.state.loading,message:this.state.loadingMessage}),s.a.createElement(Ge,{open:this.state.snackOpen,handleClose:this.handleSnackClose,message:this.state.snackMessage,variant:this.state.snackVariant})):s.a.createElement(ee.a,{to:"/login"})}}]),t}(s.a.Component),nn=Object(m.b)(function(e,t){return{userSession:e.userSession,domains:e.domains,nginxConfigs:e.nginxConfigs,nginxPresetParams:e.nginxPresetParams}},function(e){return{dispatch:e}})(Object(ne.withStyles)(re)(an)),rn=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).sharedView=null,a.handleSnackClose=function(e,t){"clickaway"!==t&&a.setState({snackOpen:!1})},a.state={snackOpen:!1,snackMessage:"",snackVariant:null,_nginxConfigPath:"",_composeConfigPath:"",_defaultNginxDomain:"",_nginxHtpasswdDir:""},a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({loading:!0,loadingMessage:null}),setTimeout(function(){var t={loading:!1,loadingMessage:null};e.props.settings.map(function(e){t["_"+e.name]=e.value}),e.setState(t)},1e3)}},{key:"openSnack",value:function(e,t){this.setState({snackOpen:!0,snackMessage:e,snackVariant:t||"success"})}},{key:"saveSettings",value:function(){var e=Object(i.a)(r.a.mark(function e(t){var a,n,i=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.formEl.validate()){e.next=14;break}this.setState({loading:!0,loadingMessage:"Saving..."}),a=[],e.t0=r.a.keys(this.state);case 5:if((e.t1=e.t0()).done){e.next=11;break}if(0!=(n=e.t1.value).indexOf("_")){e.next=9;break}return e.delegateYield(r.a.mark(function e(){var t,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.substring(1),o={id:i.props.settings.find(function(e){return e.name==t}).id,name:t,value:i.state[n]},a.push(o),e.next=5,H.endpoints.Settings.update(o);case 5:case"end":return e.stop()}},e)})(),"t2",9);case 9:e.next=5;break;case 11:this.props.dispatch({type:"SET_SETTINGS",data:a}),this.setState({loading:!1,loadingMessage:null}),this.openSnack("Settings saved");case 14:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSettingField",value:function(e){var t=this,a=this.props.literals;return s.a.createElement(se.m,{item:!0,xs:12,style:{textAlign:"left",paddingBottom:20}},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{required:!0,name:"_"+e.name,className:"form-control",value:this.state["_"+e.name],onChange:function(a){var n={};n["_"+e.name]=a.target.value,t.setState(n)},label:a.settings[e.name],type:"text",fullWidth:!0}),s.a.createElement("div",{className:"invalid-feedback"})))}},{key:"render",value:function(){var e=this;if(!this.props.userSession.token)return s.a.createElement(ee.a,{to:"/login"});var t=this.props.classes;return this.props.settings.sort(function(e,t){return e.id<t.id?-1:e.id>t.id?1:0}),s.a.createElement(ge,{ref:function(t){return e.sharedView=t},history:this.props.history,pageIndex:3,notify:this.openSnack.bind(this)},s.a.createElement(se.m,{item:!0,xs:12},s.a.createElement(se.m,{container:!0,spacing:16},s.a.createElement(se.m,{item:!0,xs:12},s.a.createElement(se.y,{className:t.paper},s.a.createElement("div",{className:t.tableTitleDiv},"Settings"),s.a.createElement(se.h,{variant:"middle",style:{marginLeft:0,marginRight:0,marginTop:0,marginBottom:20}}),s.a.createElement(se.b,{variant:"contained",color:"primary",style:{textTransform:"none",position:"absolute",right:10,top:10},onClick:this.saveSettings.bind(this)},"Save"),s.a.createElement(mt,{ref:function(t){return e.formEl=t}},s.a.createElement("div",{style:{padding:10}},this.props.settings.map(function(t){return s.a.createElement("div",{key:"setting"+t.id,className:"form-group"},s.a.createElement(se.m,{container:!0,spacing:16},e.getSettingField(t)))}))))))),s.a.createElement(Ge,{open:this.state.snackOpen,handleClose:this.handleSnackClose,message:this.state.snackMessage,variant:this.state.snackVariant}),s.a.createElement(me,{show:this.state.loading}))}}]),t}(s.a.Component),on=Object(m.b)(function(e,t){return{userSession:e.userSession,settings:e.settings,literals:e.literals}},function(e){return{dispatch:e}})(Object(ne.withStyles)(re)(rn)),sn=a(181),ln=function(e){function t(e){var a;return Object(W.a)(this,t),(a=Object(Z.a)(this,Object($.a)(t).call(this,e))).handleSnackClose=function(e,t){"clickaway"!==t&&a.setState({snackOpen:!1})},a.state={snackOpen:!1,snackMessage:"",snackVariant:null,username:"admin",password:"mdundek.heart"},a}return Object(Q.a)(t,e),Object(G.a)(t,[{key:"login",value:function(){var e=this;if(this.formEl.validate()){var t={password:this.state.password};-1===this.state.username.indexOf("@")?t.username=this.state.username:t.email=this.state.username,X.login(t).then(function(){}).catch(function(t){e.setState({snackOpen:!0,snackVariant:"error",snackMessage:401===t.status?"Wrong username or password":403===t.status?"User is not an administrator":"An error occured, please try again later"}),console.log("ERROR =>",t)})}}},{key:"getModalStyle",value:function(){return{top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(50,"%)")}}},{key:"render",value:function(){var e=this;if(this.props.userSession.token)return s.a.createElement(ee.a,{to:"/solution"});var t=this.props.classes;return s.a.createElement("div",{className:"App"},s.a.createElement("header",{className:"App-header"},s.a.createElement("img",{src:oe.a,className:"App-logo",alt:"logo"}),s.a.createElement("p",null,"Server Docker Farm")),s.a.createElement("div",{className:"App-body"},s.a.createElement(se.m,{item:!0,xs:12,style:{marginTop:100}},s.a.createElement(se.m,{container:!0,justify:"center",spacing:16},s.a.createElement(se.m,{item:!0,xs:12,className:t.title},"LOGIN"),s.a.createElement(se.m,{item:!0},s.a.createElement(se.y,{className:t.paper},s.a.createElement(mt,{ref:function(t){return e.formEl=t}},s.a.createElement("div",{className:t.margin},s.a.createElement(se.m,{container:!0,spacing:32,alignItems:"flex-end"},s.a.createElement(se.m,{item:!0},s.a.createElement(sn.a,null)),s.a.createElement(se.m,{item:!0,md:!0,sm:!0,xs:!0},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{id:"username",value:this.state.username,onChange:function(t){e.setState({username:t.target.value})},label:"Username",type:"text",fullWidth:!0,autoFocus:!0,required:!0}),s.a.createElement("div",{className:"invalid-feedback"})))),s.a.createElement(se.m,{container:!0,spacing:32,alignItems:"flex-end"},s.a.createElement(se.m,{item:!0},s.a.createElement(sn.b,null)),s.a.createElement(se.m,{item:!0,md:!0,sm:!0,xs:!0},s.a.createElement("div",{className:"form-group"},s.a.createElement(se.C,{id:"password",value:this.state.password,onChange:function(t){e.setState({password:t.target.value})},label:"Password",type:"password",fullWidth:!0,required:!0}),s.a.createElement("div",{className:"invalid-feedback"})))),s.a.createElement(se.m,{container:!0,justify:"center",style:{marginTop:"40px"}},s.a.createElement(se.b,{variant:"contained",color:"primary",style:{textTransform:"none"},onClick:this.login.bind(this),fullWidth:!0},"Login"))))))))),s.a.createElement(Ge,{open:this.state.snackOpen,handleClose:this.handleSnackClose,message:this.state.snackMessage,variant:this.state.snackVariant}))}}]),t}(s.a.Component),cn=Object(m.b)(function(e,t){return{userSession:e.userSession}},function(e){return{dispatch:e}})(Object(ne.withStyles)(function(e){return{root:{flexGrow:1},title:{fontSize:32,color:"#ffffff"},paper:{padding:e.spacing.unit,width:400},margin:{margin:2*e.spacing.unit},padding:{padding:e.spacing.unit},modalPaper:{position:"absolute",width:50*e.spacing.unit,backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],padding:4*e.spacing.unit}}})(ln)),un={en:a(261)},dn=U();X.store=dn,J.store=dn,dn.dispatch({type:"LOAD_LITERALS",data:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en";return un[e]}("en")}),sessionStorage.accessToken&&"null"!==sessionStorage.accessToken&&Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.setUser(JSON.parse(sessionStorage.accessToken));case 2:case"end":return e.stop()}},e)}))();var mn=s.a.createElement(u.a,{basename:"/psh-admin"},s.a.createElement(m.a,{store:dn},s.a.createElement("div",null,s.a.createElement(d.a,{exact:!0,path:"/",component:ae}),s.a.createElement(d.a,{path:"/login",component:cn}),s.a.createElement(d.a,{path:"/solution",component:Ot}),s.a.createElement(d.a,{path:"/docker",component:Ia}),s.a.createElement(d.a,{path:"/nginx",component:nn}),s.a.createElement(d.a,{path:"/config",component:on}))));c.a.render(mn,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()});t.default=mn},91:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"}},[[5507,2,1]]]);
//# sourceMappingURL=main.b20fee54.chunk.js.map